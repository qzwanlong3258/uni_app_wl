(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["pages-todoChild-promoteGoods-index"],{"0982":function(t,e,n){var i=n("8605");"string"===typeof i&&(i=[[t.i,i,""]]),i.locals&&(t.exports=i.locals);var r=n("4f06").default;r("487eafae",i,!0,{sourceMap:!1,shadowMode:!1})},"1af6":function(t,e,n){var i=n("63b6");i(i.S,"Array",{isArray:n("9003")})},"1ee4":function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var i={props:{infor:{type:Object,default:function(){return{}}},checked:{type:Boolean,default:!1}}};e.default=i},"20fd":function(t,e,n){"use strict";var i=n("d9f6"),r=n("aebd");t.exports=function(t,e,n){e in t?i.f(t,e,r(0,n)):t[e]=n}},"2ebd":function(t,e,n){"use strict";n.r(e);var i=n("96e6"),r=n.n(i);for(var a in i)"default"!==a&&function(t){n.d(e,t,(function(){return i[t]}))}(a);e["default"]=r.a},3056:function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0,n("386d");var i=n("5e5c"),r=n("4cc3"),a={data:function(){return{search:{icon:i.SEARCH,value:""}}},computed:{handSearchValueThrottl:function(){return(0,r.waterTap)(this.handSearchValue,1e3)}},methods:{handSearchValue:function(){this.$emit("change",this.search.value)}}};e.default=a},"3cf0":function(t,e,n){"use strict";n.r(e);var i=n("45f5"),r=n("b6c2");for(var a in r)"default"!==a&&function(t){n.d(e,t,(function(){return r[t]}))}(a);n("9533");var o,s=n("f0c5"),c=Object(s["a"])(r["default"],i["b"],i["c"],!1,null,"c50793d0",null,!1,i["a"],o);e["default"]=c.exports},"40b9":function(t,e,n){"use strict";var i,r=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("v-uni-view",{staticClass:"search-box"},[n("i",{staticClass:"icon iconfont iconiconfontzhizuobiaozhun22"}),n("v-uni-input",{attrs:{type:"text",placeholder:"搜索","placeholder-class":"placeholder-class"},on:{input:function(e){arguments[0]=e=t.$handleEvent(e),t.handSearchValueThrottl.apply(void 0,arguments)}},model:{value:t.search.value,callback:function(e){t.$set(t.search,"value",e)},expression:"search.value"}})],1)},a=[];n.d(e,"b",(function(){return r})),n.d(e,"c",(function(){return a})),n.d(e,"a",(function(){return i}))},"45f5":function(t,e,n){"use strict";var i,r=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("v-uni-view",{staticClass:"canvas_box",style:{visibility:t.hideBox?"hidden":"visible"},attrs:{"data-mark":"box",catchtouchmove:"nothing"},on:{click:function(e){arguments[0]=e=t.$handleEvent(e),t.hideCanvas.apply(void 0,arguments)}}},[n("v-uni-view",{attrs:{hidden:t.hideShareCanvas}},[n("v-uni-canvas",{style:{width:t.width+"px",height:t.height+"px"},attrs:{"canvas-id":"canvas"},on:{click:function(e){arguments[0]=e=t.$handleEvent(e),t.hideCanvas.apply(void 0,arguments)}}}),n("v-uni-view",{staticClass:"share_set"},[n("v-uni-view",{staticClass:"share_option",style:{visibility:t.hideBtnSet?"hidden":"visible"}},[n("v-uni-image",{attrs:{src:t.downloadImg},on:{click:function(e){arguments[0]=e=t.$handleEvent(e),t.saveForAlubm.apply(void 0,arguments)}}}),n("v-uni-text",{on:{click:function(e){arguments[0]=e=t.$handleEvent(e),t.saveForAlubm.apply(void 0,arguments)}}},[t._v("保存到相册")])],1),n("v-uni-button",{staticClass:"under_button",style:{visibility:t.hideBtnSet?"visible":"hidden"},on:{click:function(e){arguments[0]=e=t.$handleEvent(e),t.junpAuthorization.apply(void 0,arguments)}}},[t._v("点击授权")])],1)],1)],1)},a=[];n.d(e,"b",(function(){return r})),n.d(e,"c",(function(){return a})),n.d(e,"a",(function(){return i}))},"487b1":function(t,e,n){"use strict";var i=n("803f"),r=n.n(i);r.a},"4a8f":function(t,e,n){"use strict";var i=n("dbce"),r=n("4ea4");Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0,n("96cf");var a=r(n("3b8d"));n("c5f6");var o=i(n("5cd2")),s=n("5e5c"),c=n("6e47"),u={data:function(){return{canvas:null,canvasComponent:null,hideShareCanvas:!0,shareCanvas:null,hideBtnSet:!1,hideBox:!0,downloadImg:s.DOWNLOAD_IMG,qRCodeUrl:""}},props:{width:{type:Number,required:!0},height:{type:Number,required:!0},config:{type:Object,defautl:function(){return{}}}},mounted:function(){this.canvasComponent=wx.createCanvasContext("canvas",this)},methods:{checkPermission:function(){var t=this;this.canvas&&this.canvas.checkPermission().then((function(e){e.code==o.renum.UNAUTHORIZED?t.showJump():e.code==o.renum.NOPERMISSION||e.code==o.renum.HASPERMISSION?t.showShareCanvas():console.warn("检测权限返回结果错误")}))},junpAuthorization:function(){o.IWX.invoke("openSetting")},showBox:function(){this.hideBox=!1},showShareCanvas:function(){this.hideBox=!1,this.hideShareCanvas=!1,this.hideBtnSet=!1},showJump:function(){this.hideBox=!1,this.hideShareCanvas=!1,this.hideBtnSet=!0},hideCanvas:function(t){t!=o.renum.INITIATIVE&&"box"!=t.currentTarget.dataset.mark||(this.hideBox=!0,this.hideShareCanvas=!0)},switchAuthorization:function(){this.hideCanvas(o.renum.INITIATIVE),this.hideBtnSet=!0},saveForAlubm:function(){var t=this;this.getTempImgPath().then((function(e){t.canvas.saveImgLocal(e).then((function(e){t.hideCanvas(o.renum.INITIATIVE)})).catch((function(e){t.switchAuthorization()}))}))},drawShareCanvas:function(){var t=this;this.canvas.draw().then((function(e){t.showShareCanvas()})).catch((function(e){e.code==o.renum.UNAUTHORIZED&&t.showJump()})).then((function(t){uni.hideLoading()}))},share:function(){var t=(0,a.default)(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(t.t0=!this.miniCodeUrl,!t.t0){t.next=5;break}return t.next=4,this.genderMiniCode();case 4:this.miniCodeUrl=t.sent;case 5:null===this.canvas?(uni.showLoading({title:"正在加载"}),this.canvas=new o.default({ctx:this.canvasComponent,imgUrl:this.config.imgUrl,qRCodeUrl:this.qRCodeUrl,title:this.config.title,price:this.config.price,width:this.width,height:this.height,qRCodeWidth:280}),this.checkPermission(),this.showBox(),this.drawShareCanvas()):(this.showBox(),this.canvas.isDraw||this.drawShareCanvas(),this.checkPermission());case 6:case"end":return t.stop()}}),t,this)})));function e(){return t.apply(this,arguments)}return e}(),getTempImgPath:function(){var t=this;return new Promise((function(e,n){uni.canvasToTempFilePath({x:0,y:0,canvasId:"canvas",success:function(t){e(t.tempFilePath)},fail:function(t){console.error(t)}},t)}))},genderMiniCode:function(){var t=this;return(0,c.getUnlimited)({page:this.config.jumpPath,scene:this.config.scene,width:600,is_hyaline:!0}).then((function(e){t.qRCodeUrl=e})).catch((function(e){t.hideCanvas(o.renum.INITIATIVE)}))}}};e.default=u},"4cc3":function(t,e,n){"use strict";n("20d6"),n("c5f6"),n("28a5"),n("a481"),n("6b54");var i=function(t){var e=t.getFullYear(),n=t.getMonth()+1,i=t.getDate(),a=t.getHours(),o=t.getMinutes(),s=t.getSeconds();return[e,n,i].map(r).join("/")+" "+[a,o,s].map(r).join(":")},r=function(t){return t=t.toString(),t[1]?t:"0"+t},a=function(t){t=t.toString().length<13?1e3*t:t;var e=new Date(t),n=e.getFullYear()+"-",i=(e.getMonth()+1<10?"0"+(e.getMonth()+1):e.getMonth()+1)+"-",r=(e.getDate()<10?"0"+e.getDate():e.getDate())+" ",a=(e.getHours()<10?"0"+e.getHours():e.getHours())+":",o=(e.getMinutes()<10?"0"+e.getMinutes():e.getMinutes())+":",s=e.getSeconds()<10?"0"+e.getSeconds():e.getSeconds();return n+i+r+a+o+s},o=function(t,e){if(""===t.trim()){var n=e?e+"不可为空":"不可为空";return uni.showToast({title:n,icon:"none",mask:!0,duration:2e3}),!1}return!0},s=function(t,e){if(t=t.toString(),""===t.trim()){var n=e?e+"不可为空":"手机号不可为空";return uni.showToast({title:n,icon:"none",mask:!0,duration:2e3}),!1}var i=/^((13[0-9])|(14[5,7])|(15[0-3,5-9])|(17[0,3,5-8])|(18[0-9])|166|198|199|(147))\d{8}$/gi,r=i.test(t);if(!r){var a=e?"请输入正确"+e:"请输入正确手机号";return uni.showToast({title:a,icon:"none",mask:!0,duration:2e3}),!1}return!0},c=function(t,e){if(t=t.toString(),""===t.trim()){var n=e?e+"不可为空":"身份证不可为空";return uni.showToast({title:n,icon:"none",mask:!0,duration:2e3}),!1}if(18!=t.length){var i=e?"请输入正确"+e:"请输入正确身份证号";return uni.showToast({title:i,icon:"none",mask:!0,duration:2e3}),!1}return!0},u=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},e=t.ox,n=void 0===e?0:e,i=t.oy,r=void 0===i?0:i,a=t.ax,o=void 0===a?0:a,s=t.ay,c=void 0===s?0:s,u=t.angle,l=void 0===u?0:u,d={c:0,d:0};return d.c=parseInt(n+(o-n)*Math.cos(l)+(c-r)*Math.sin(l)),d.d=parseInt(r+(o-n)*-Math.sin(l)+(c-r)*Math.cos(l)),d},l=function(t){return null==t?0:("string"!=typeof t&&(t+=""),t.replace(/[^a-z]\d*/g,"01").length)};function d(t,e){var n,i,r;try{n=t.toString().split(".")[1].length}catch(a){n=0}try{i=e.toString().split(".")[1].length}catch(a){i=0}return r=Math.pow(10,Math.max(n,i)),((t*r+e*r)/r).toFixed(2)}function f(t,e){var n,i,r;try{n=t.toString().split(".")[1].length}catch(a){n=0}try{i=e.toString().split(".")[1].length}catch(a){i=0}return r=Math.pow(10,Math.max(n,i)),n>=i?n:i,((t*r-e*r)/r).toFixed(2)}function h(t,e){var n=0,i=t.toString(),r=e.toString();try{n+=i.split(".")[1].length}catch(a){}try{n+=r.split(".")[1].length}catch(a){}return Number(i.replace(".",""))*Number(r.replace(".",""))/Math.pow(10,n)}function g(t,e){if("function"!==typeof t)return console.warn("func 参数必须是Function类型"),function(){};if("number"!==typeof e)return console.warn("delay 参数必须是Number类型"),function(){};var n=Date.now();return function(){Date.now()-n>=e&&(t.call(this,arguments),n=Date.now())}}function p(t,e){if("function"!==typeof t)return console.warn("func 参数必须是Function类型"),function(){};if("number"!==typeof e)return console.warn("wait 参数必须是Number类型"),function(){};var n=null;return function(){null!==n&&clearTimeout(n),n=setTimeout(t,e)}}function v(t){var e=getCurrentPages(),n=e.findIndex((function(e){return e.route==t.substring(1)}));-1!=n?uni.navigateBack({delta:e.length-n-1}):uni.navigateTo({url:t,fail:function(){uni.switchTab({url:t})}})}var m=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},e=t.lat1,n=void 0===e?0:e,i=t.lng1,r=void 0===i?0:i,a=t.lat2,o=void 0===a?0:a,s=t.lng2,c=void 0===s?0:s,u=n*Math.PI/180,l=o*Math.PI/180,d=u-l,f=r*Math.PI/180-c*Math.PI/180,h=6378137,g=2*h*Math.asin(Math.sqrt(Math.pow(Math.sin(d/2),2)+Math.cos(u)*Math.cos(l)*Math.pow(Math.sin(f/2),2)));return parseInt(g)};t.exports={formatTime:i,time:a,checkRequestStr:o,checkPhone:s,checkIdCardLength:c,anglePoint:u,getBLen:l,accAdd:d,subtr:f,accMul:h,waterTap:g,debounce:p,toRoute:v,getDistance:m}},"52ce":function(t,e,n){"use strict";var i=n("0982"),r=n.n(i);r.a},"549b":function(t,e,n){"use strict";var i=n("d864"),r=n("63b6"),a=n("241e"),o=n("b0dc"),s=n("3702"),c=n("b447"),u=n("20fd"),l=n("7cd6");r(r.S+r.F*!n("4ee1")((function(t){Array.from(t)})),"Array",{from:function(t){var e,n,r,d,f=a(t),h="function"==typeof this?this:Array,g=arguments.length,p=g>1?arguments[1]:void 0,v=void 0!==p,m=0,b=l(f);if(v&&(p=i(p,g>2?arguments[2]:void 0,2)),void 0==b||h==Array&&s(b))for(e=c(f.length),n=new h(e);e>m;m++)u(n,m,v?p(f[m],m):f[m]);else for(d=b.call(f),n=new h;!(r=d.next()).done;m++)u(n,m,v?o(d,p,[r.value,m],!0):r.value);return n.length=m,n}})},"54a1":function(t,e,n){n("6c1c"),n("1654"),t.exports=n("95d5")},"5cd2":function(t,e,n){"use strict";var i=n("4ea4");Object.defineProperty(e,"__esModule",{value:!0}),e.default=e.IWX=e.renum=e.Result=void 0,n("ac6a"),n("5df3");var r=i(n("d225")),a=i(n("b0b4"));n("28a5"),n("6b54");n("6e47");var o={stringSegment:function(t,e){for(var n=[],i="",r=0;r<t.length;r++)i+=t.charAt(r),r%e!=e-1&&r!=t.length-1||(n.push(i),i="");return n},add0InFront:function(t,e){if(t=t.toString(),t.length<e)for(var n=e-t.length,i=0;i<n;i++)t="0"+t;return t},invert:function(t){return t=t.toString(),t.split("").reverse().join("")},toCharBy62:function(t){return t=parseInt(t),t>=0&&t<=9?String.fromCharCode(t+48):t>=10&&t<=35?String.fromCharCode(t+87):t>=36&&t<=62?String.fromCharCode(t+29):(console.warn("该code无法转换为字符串,code必须大于等于0，小于或等于62"),null)},compression:function(t){var e="%3D",n="%26",i=(t.substring(t.indexOf(e)+e.length,t.indexOf(n)),t.substring(t.indexOf(e)+e.length));console.log(i)},isContain:function(t,e){return-1!==t.indexOf(e)}},s=function(){function t(e,n,i){(0,r.default)(this,t),this.code=e,this.msg=n,this.data=i}return(0,a.default)(t,[{key:"setData",value:function(t){return this.data=t,this}}]),t}();e.Result=s;var c={AUTHORIZEDSUCCESS:88,AUTHORIZEDFAILURE:89,UNAUTHORIZED:90,HASPERMISSION:91,NOPERMISSION:92,SUCCESS:93,FAIL:94,INITIATIVE:95};e.renum=c;var u={invoke:function(t,e){var n=new Promise((function(n,i){var r={success:function(t){n(new s(c.SUCCESS).setData(t))},fail:function(t){console.warn(t),i(new s(c.FAIL).setData(t))}};Object.assign(r,e),wx[t](r)}));return n},getIsPermission:function(t){var e=new Promise((function(e,n){wx.getSetting({success:function(n){t in n.authSetting&&n.authSetting[t]?e(new s(c.HASPERMISSION).setData(n)):(console.warn("没有"+t+"权限"),e(new s(c.NOPERMISSION).setData(n)))},fail:function(t){console.warn("权限检测失败"),n(new s(!1,"权限检测失败",t))}})}));return e}};e.IWX=u;var l=function(){function t(e){var n=e.ctx,i=e.imgUrl,a=e.qRCodeUrl,o=e.title,s=e.price,c=e.width,u=void 0===c?250:c,l=e.height,d=void 0===l?400:l,f=e.qRCodeWidth,h=void 0===f?280:f;(0,r.default)(this,t),this.ctx=n,this.backgroundColor="#fff",this.imgUrl=i,this.title=o,this.titleSize=14,this.titleColor="#262626",this.price=s,this.priceColor="#E02832",this.width=u,this.height=d,this.borderWidth=10,this.borderBottom=this.height/5,this.borderLineWidth=1,this.borderColor="#DEDEDE",this.borderAngle="miter",this.segmentLength=12,this.qRCodeUrl=a,this.qRCodeWidth=h,this.qRCodeDesc="长按图片，识别二维码查看商品详情",this.qRCodeDescSize=14,this.qRCodeDescColor="#262626",this.isDraw=!1}return(0,a.default)(t,null,[{key:"getCanvasById",value:function(t){return this}}]),(0,a.default)(t,[{key:"getSystemWidthHeight",value:function(){u.invoke("getSystemInfo").then((function(t){console.log(t)}))}},{key:"draw",value:function(){var t=this;return new Promise((function(e,n){var i=t.checkPermission().then((function(t){t.code==c.UNAUTHORIZED&&n(t)}));i.then((function(){var n=t.drawImg(),i=t.drawLittleProgramCode().then((function(e){t.drawCodeDesc()}));t.fillBackgroundColor(),t.drawRet();var r=o.stringSegment(t.title,t.segmentLength);t.drawTextArr(t.pruneTitleArr(r)),Promise.all([n,i]).then((function(n){t.ctx.draw(),t.isDraw=!0,e(c.SUCCESS)}))}))}))}},{key:"checkPermission",value:function(){return new Promise((function(t,e){u.getIsPermission("scope.writePhotosAlbum").then((function(e){e.code==c.NOPERMISSION&&!1===e.data.authSetting["scope.writePhotosAlbum"]?t(new s(c.UNAUTHORIZED)):e.code!=c.NOPERMISSION&&e.code!=c.HASPERMISSION||t(e)}))}))}},{key:"fillBackgroundColor",value:function(){this.ctx.setFillStyle(this.backgroundColor),this.ctx.fillRect(0,0,this.width,this.height)}},{key:"drawRet",value:function(){this.ctx.setStrokeStyle(this.borderColor);var t=this.width-2*this.borderWidth,e=this.height-this.borderBottom-this.borderWidth;this.drawLine(this.borderWidth,this.borderWidth,this.borderWidth,e+this.borderWidth),this.drawLine(this.borderWidth,this.height-this.borderBottom,t+this.borderWidth,e+this.borderWidth),this.drawLine(t+this.borderWidth,e+this.borderWidth,t+this.borderWidth,this.borderWidth),this.drawLine(t+this.borderWidth,this.borderWidth,this.borderWidth,this.borderWidth)}},{key:"drawLine",value:function(t,e,n,i){this.ctx.beginPath(),this.ctx.setStrokeStyle(this.borderColor),this.ctx.setLineWidth(this.borderLineWidth),this.ctx.setLineJoin(this.borderAngle),this.ctx.moveTo(t,e),this.ctx.lineTo(n,i),this.ctx.stroke()}},{key:"drawTextArr",value:function(t){var e=this,n=this.height-this.borderBottom-this.borderWidth,i=this.width-2*this.borderWidth,r=this.titleAlignSpacing(n,i,t);this.ctx.setFontSize(this.titleSize),this.ctx.setFillStyle(this.titleColor),this.ctx.setTextAlign("center"),t.forEach((function(t,n){2==n&&e.ctx.setFillStyle(e.priceColor),e.ctx.fillText(t,e.width/2,i+e.borderWidth+r+e.titleSize),r+=parseInt(1.5*e.titleSize)}))}},{key:"titleAlignSpacing",value:function(t,e,n){var i=parseInt((t-e-1.5*this.titleSize*n.length)/2),r=(t-e)/25;while(i<r&&this.titleSize>8)i<r&&this.titleSize--,i=parseInt((t-e-1.5*this.titleSize*n.length)/2);return i}},{key:"drawLittleProgramCode",value:function(){var t=this;return this.qRCodeWidth=this.borderBottom-2*this.borderWidth,new Promise((function(e,n){console.log(t.qRCodeUrl),u.invoke("getImageInfo",{src:t.qRCodeUrl}).then((function(n){t.ctx.drawImage(n.data.path,t.borderWidth,t.height-t.borderBottom+t.borderWidth,t.qRCodeWidth,t.qRCodeWidth),e(new s(!0,"绘制小程序码成功",n))}))}))}},{key:"pruneTitleArr",value:function(t){var e=[];return t.length>2&&(e[0]=t[0],e[1]=t[1].substring(-3)+"...",t=e),t.push("￥"+this.price.toFixed(2)),t}},{key:"drawImg",value:function(){var t=this;return new Promise((function(e,n){var i=t.ctx,r=t.borderWidth,a=t.width-2*t.borderWidth,o=t.urlConversion(t.imgUrl);u.invoke("getImageInfo",{src:o}).then((function(t){i.drawImage(t.data.path,r,r,a,a),e(new s(!0,"推广图绘制正中大图成功"))}))}))}},{key:"urlConversion",value:function(t){return t}},{key:"saveImgLocal",value:function(t){var e=this;return new Promise((function(n,i){e.checkPermission().then((function(r){r.code==c.UNAUTHORIZED?n(r):r.code==c.NOPERMISSION?e.applyAuthorization().then((function(e){u.invoke("saveImageToPhotosAlbum",{filePath:t}).then((function(t){n(new s(c.SUCCESS))})).catch((function(t){i(t)}))})).catch((function(t){i(t)})):r.code==c.HASPERMISSION&&u.invoke("saveImageToPhotosAlbum",{filePath:t}).then((function(t){n(new s(c.SUCCESS))})).catch((function(t){i(t)}))}))}))}},{key:"applyAuthorization",value:function(){return new Promise((function(t,e){u.invoke("authorize",{scope:"scope.writePhotosAlbum"}).then((function(e){t(new s(c.AUTHORIZEDSUCCESS))})).catch((function(t){console.warn("用户拒绝了授权"),e(new s(c.AUTHORIZEDFAILURE))}))}))}},{key:"drawCodeDesc",value:function(){var t=this,e=o.stringSegment(this.qRCodeDesc,10),n=this.codeDescAlignSpacing(e),i=(this.width-3*this.borderWidth-this.qRCodeWidth)/2+this.borderWidth+this.qRCodeWidth;this.ctx.setFontSize(this.qRCodeDescSize),this.ctx.setFillStyle(this.qRCodeDescColor),this.ctx.setTextAlign("center"),e.forEach((function(e,r){t.ctx.fillText(e,i,t.height-t.borderBottom+t.borderWidth+n+t.qRCodeDescSize),n+=parseInt(1.5*t.qRCodeDescSize)}))}},{key:"codeDescAlignSpacing",value:function(t){var e=parseInt((this.borderBottom-this.borderWidth-6*this.qRCodeDescSize/4*t.length)/2),n=this.borderBottom/10;while(e<n&&this.qRCodeDescSize>8)e<n&&this.qRCodeDescSize--,e=parseInt((this.borderBottom-this.borderWidth-6*this.qRCodeDescSize/4*t.length)/2);return e}}]),t}();e.default=l},"5d64":function(t,e,n){"use strict";n.r(e);var i=n("ec54"),r=n("f45c");for(var a in r)"default"!==a&&function(t){n.d(e,t,(function(){return r[t]}))}(a);n("654a");var o,s=n("f0c5"),c=Object(s["a"])(r["default"],i["b"],i["c"],!1,null,"fed3cf0c",null,!1,i["a"],o);e["default"]=c.exports},"654a":function(t,e,n){"use strict";var i=n("f52d"),r=n.n(i);r.a},"6d67":function(t,e,n){"use strict";var i=n("4ea4");Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var r=i(n("bd86"));n("28a5"),n("6c7b");var a={data:function(){return{}},props:{canvasFlag:{type:Boolean,default:!0},posterObj:{type:Object,default:{url:"https://img0.zuipin.cn/mp_zuipin/poster/hch-pro.jpg",icon:"https://img0.zuipin.cn/mp_zuipin/poster/hch-hyj.png",title:"诗酒茶系列 武夷大红袍 2018年 花香型中火 一级 体验装 16g",discountPrice:"250.00",orignPrice:"300.00",code:"https://img0.zuipin.cn/mp_zuipin/poster/hch-code.png"}}},methods:{roundRect:function(t,e,n,i,r,a,o,s,c){if(t.beginPath(),t.arc(e+a,n+a,a,Math.PI,1.5*Math.PI),t.moveTo(e+a,n),t.lineTo(e+i-a,n),t.arc(e+i-a,n+a,a,1.5*Math.PI,2*Math.PI),t.lineTo(e+i,n+r-a),t.arc(e+i-a,n+r-a,a,0,.5*Math.PI),t.arc(e+a,n+r-a,a,.5*Math.PI,Math.PI),t.lineTo(e,n+a),"btn"==c){var u=t.createLinearGradient(0,0,200,0);u.addColorStop(0,o),u.addColorStop(1,s),t.setFillStyle(u),t.fill()}else o&&(t.setFillStyle(o),t.fill()),s&&(t.setStrokeStyle(s),t.stroke());t.closePath(),t.clip()},canvasMultiLineText:function(t,e,n,i){for(var r=e.split(""),a="",o=[],s=0;s<r.length;s++)t.measureText(a).width<n?a+=r[s]:(s--,o.push(a),a="");if(o.push(a),o.length>i){for(var c=o.slice(0,i),u=c[1],l="",d=[],f=0;f<u.length;f++){if(!(t.measureText(l).width<n))break;l+=u[f]}d.push(l);var h=d[0]+"...";c.splice(i-1,1,h),o=c}return o},codeImg:function(){var t=this;return new Promise((function(e,n){request({method:"get",url:"/spSupport/getwxacodeunlimit",header:{"Content-Type":"application/x-www-form-urlencoded"},data:{version:t.$parent.globalData.version,scene:"sku=".concat(t.sku),page:"pages/product/detail",width:"128px"}}).then((function(t){if(0==t.data.code){var n=wx.getFileSystemManager(),i="tmp_img_src",a="".concat(wx.env.USER_DATA_PATH,"/").concat(i,".jpg");n.writeFile({filePath:a,data:t.data.data,encoding:"binary",success:function(){e(a)},fail:function(){this.canvasFlag=!0,uni.showToast({title:"海报生成失败",duration:2e3,icon:"none"})}})}else uni.showToast((0,r.default)({title:t.data.message,icon:"none",duration:2e3},"icon","none"))})).catch((function(){t.canvasFlag=!0,uni.showToast({title:"海报生成失败",duration:2e3,icon:"none"})}))}))},createCanvasImage:function(){var t=this;console.log(this.posterObj,"posterObj"),console.log("海报生成中"),wx.showLoading({title:"海报生成中..."});var e=this,n=wx.getSystemInfoSync();this.phoneH=n.windowHeight,this.phoneW=n.windowWidth;this.phoneW;var i=this.phoneH/667;console.log(this.phoneH,this.phoneW);var r=wx.createCanvasContext("myCanvas"),a=this.posterObj.url,o=this.posterObj.icon,s=this.posterObj.code,c="https://www.feiaizn.com/images/20200512152811_close_btn.png";console.log(r),console.log(this),r.draw(),r.save(),this.roundRect(r,50,40,this.phoneW-100,this.phoneH-120,10,"#fff","#fff"),r.restore(),r.save(),this.roundRect(r,50,40,this.phoneW-100,370*i,10,"#f7f7f7","#f7f7f7"),r.restore(),uni.getImageInfo({src:a,success:function(t){r.save(),e.roundRect(r,(e.phoneW-(e.phoneW-130))/2,55,e.phoneW-130,250*i,10,"#f7f7f7","#f7f7f7"),r.drawImage(t.path,(e.phoneW-(e.phoneW-130))/2,55,e.phoneW-130,250*i,10),r.restore(),r.draw(!0)},fail:function(){e.canvasFlag=!0,uni.showToast({title:"海报生成失败",duration:2e3,icon:"none"})}}),uni.getImageInfo({src:c,success:function(t){r.drawImage(t.path,e.phoneW-100+50+5,40,24,24),r.draw(!0)},fail:function(){e.canvasFlag=!0,uni.showToast({title:"海报生成失败",duration:2e3,icon:"none"})}}),setTimeout((function(){r.setGlobalAlpha(1),r.setFillStyle("#1c1c1c"),r.setFontSize(14),r.font="normal bold 14px sans-serif";for(var e=t.posterObj.title,n=t.canvasMultiLineText(r,e,t.phoneW-130,2),a=360,o=65,s=18,c=0;c<n.length;c++)r.fillText(n[c],o,(a+s*c-15)*i,t.phoneW-130),r.draw(!0)}),500),uni.getImageInfo({src:o,success:function(t){r.drawImage(t.path,65,380*i,44,15),r.draw(!0)},fail:function(){e.canvasFlag=!0,uni.showToast({title:"海报生成失败",duration:2e3,icon:"none"})}}),r.setFontSize(12),r.setFillStyle("#c00000"),r.font="normal 12px sans-serif",r.fillText("￥",110,396*i,60),r.setFontSize(16);var u=this.posterObj.discountPrice,l=this.posterObj.orignPrice,d=r.measureText(u).width;r.fillText(u,120,396*i,d),r.beginPath(),r.setFontSize(10),r.setFillStyle("#999");var f=r.measureText(l).width;r.fillText("￥".concat(l),120+d+5,395*i,f),r.moveTo(120+d+5,392*i),r.lineTo(120+d+5+f,392*i),r.setStrokeStyle("#999"),r.stroke(),r.closePath(),uni.getImageInfo({src:s,success:function(t){r.drawImage(t.path,(e.phoneW-70)/2,430*i,70,70),r.draw(!0)},fail:function(){e.canvasFlag=!0,uni.showToast({title:"海报生成失败",duration:2e3,icon:"none"})}}),r.setFontSize(14),r.setFillStyle("#2f1709"),r.font="normal bold 14px sans-serif",r.fillText("非客有家",(e.phoneW-60)/2,530*i,90),r.setFontSize(14),r.setFillStyle("#ff5f33"),r.font="normal 14px sans-serif",r.fillText("长按/扫描识别查看商品",(e.phoneW-140)/2,550*i,140),r.save(),this.roundRect(r,(this.phoneW-160)/2,this.phoneH-55,160,36,18,"#ff3600","#ff6a00","btn"),r.restore(),r.setFontSize(14),r.setFillStyle("#fff"),r.font="normal bold 14px sans-serif",r.fillText("保存图片",(e.phoneW-58)/2,this.phoneH-33,58),wx.hideLoading()},saveCanvasImage:function(){console.log("点击了保存"),wx.showLoading({title:"保存中..."});var t=this;uni.canvasToTempFilePath({x:50,y:40,width:this.phoneW-100,height:this.phoneH-120,destWidth:5*(this.phoneW-100),destHeight:5*(this.phoneH-120),canvasId:"myCanvas",success:function(e){uni.saveImageToPhotosAlbum({filePath:e.tempFilePath,success:function(e){wx.hideLoading(),uni.showToast({title:"图片保存成功，可以去分享啦~",duration:2e3}),t.canvasCancelEvn()},fail:function(){uni.showToast({title:"保存失败，稍后再试",duration:2e3,icon:"none"}),wx.hideLoading()}})},fail:function(){uni.showToast({title:"保存失败，稍后再试",duration:2e3,icon:"none"}),wx.hideLoading()}})},canvasCancelEvn:function(){console.log(),this.$emit("cancel",!0)}}};e.default=a},"6e47":function(t,e,n){"use strict";var i=n("4ea4");Object.defineProperty(e,"__esModule",{value:!0}),e.getUnlimited=l,e.postDesigner=f,e.postPay=h,e.getWxCode=g,e.getWxUser=p,e.getWxSignature=v,n("8e6e"),n("ac6a"),n("456d");var r=i(n("bd86"));n("96cf");var a=i(n("3b8d")),o=n("133c"),s=n("e2a7");function c(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(t);e&&(i=i.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,i)}return n}function u(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?c(Object(n),!0).forEach((function(e){(0,r.default)(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):c(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}function l(t){return d.apply(this,arguments)}function d(){return d=(0,a.default)(regeneratorRuntime.mark((function t(e){var n;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(n=getApp().globalData.accessToken,t.t0=!n,!t.t0){t.next=8;break}return t.next=5,(0,o.request)({method:"GET",url:s.GET_ACCESS_TOKEN});case 5:if(t.t1=n=t.sent.access_token,!t.t1){t.next=8;break}getApp().globalData.accessToken=n;case 8:return t.abrupt("return",(0,o.request)({method:"POST",url:s.GET_UNLIMITED,data:u({access_token:n},e)}));case 9:case"end":return t.stop()}}),t)}))),d.apply(this,arguments)}function f(t){return(0,o.request)({method:"POST",url:s.SHE_JI_SHI,showSuccessToast:!0,data:t})}function h(t){return(0,o.request)({method:"POST",url:s.PAY,showLoading:!1,hideLoading:!1,data:t})}function g(t){return(0,o.request)({method:"GET",url:"".concat(s.WEIXIN_CODE,"?appid=").concat(t.appid,"&secret=").concat(t.secret,"&code=").concat(t.code),showLoading:!1,hideLoading:!1,data:t})}function p(t){return(0,o.request)({method:"GET",url:"".concat(s.WEIXIN_USERINFO,"?access_token=").concat(t.access_token,"&openid=").concat(t.openid),showLoading:!1,hideLoading:!1,data:t})}function v(t){return(0,o.request)({method:"GET",url:s.SIGNATURE,showLoading:!1,hideLoading:!1,needToken:!1,data:t})}},7213:function(t,e,n){var i=n("24fb");e=i(!1),e.push([t.i,'@charset "UTF-8";\n/* Color\r\n--------------------------*/\n/* distance\r\n--------------------------*/\n/* radius\r\n--------------------------*/\n/**\r\n * 这里是uni-app内置的常用样式变量\r\n *\r\n * uni-app 官方扩展插件及插件市场（https://ext.dcloud.net.cn）上很多三方插件均使用了这些样式变量\r\n * 如果你是插件开发者，建议你使用scss预处理，并在插件代码中直接使用这些变量（无需 import 这个文件），方便用户通过搭积木的方式开发整体风格一致的App\r\n *\r\n */\n/**\r\n * 如果你是App开发者（插件使用者），你可以通过修改这些变量来定制自己的插件主题，实现自定义主题功能\r\n *\r\n * 如果你的项目同样使用了scss预处理，你也可以直接在你的 scss 代码中使用如下变量，同时无需 import 这个文件\r\n */\n/* 颜色变量 */\n/* 行为相关颜色 */\n/* 文字基本颜色 */\n/* 背景颜色 */\n/* 边框颜色 */\n/* 尺寸变量 */\n/* 文字尺寸 */\n/* 图片尺寸 */\n/* Border Radius */\n/* 水平间距 */\n/* 垂直间距 */\n/* 透明度 */\n/* 文章场景相关 */.goods-info-box[data-v-fed3cf0c]{display:-webkit-box;display:-webkit-flex;display:flex;width:100%;height:%?300?%;position:relative}.goods-info-box uni-image[data-v-fed3cf0c]{width:%?200?%;height:%?200?%;margin-right:%?30?%}.goods-info-box .content .title[data-v-fed3cf0c]{color:#333;min-height:%?100?%;font-size:%?34?%;display:-webkit-box;\n    /* 流体布局 */-webkit-line-clamp:2;\n    /* 多行文字溢出点点点... */-webkit-box-orient:vertical;\n    /* 从上向下垂直排列子元素 */word-break:break-all;\n    /* 允许在单词内换行 */text-overflow:ellipsis;\n    /* 显示省略符号来代表被修剪的文本 */overflow:hidden}.goods-info-box .content .desc[data-v-fed3cf0c]{margin-top:%?10?%;font-size:%?24?%;color:#999;letter-spacing:%?5?%}.goods-info-box .content .rule[data-v-fed3cf0c]{margin-top:%?24?%;font-size:%?24?%;color:#999}.goods-info-box .content .rule uni-text[data-v-fed3cf0c]:nth-child(1){color:#e8541e;background:#fceee9;margin-right:%?26?%}.goods-info-box .selected[data-v-fed3cf0c]{width:%?32?%;height:%?32?%;position:absolute;top:%?200?%;right:%?30?%;border:%?5?% solid #eee;background:#eee}.goods-info-box .active[data-v-fed3cf0c]{background:#fad64c}',""]),t.exports=e},"75fc":function(t,e,n){"use strict";n.r(e);var i=n("a745"),r=n.n(i);function a(t){if(r()(t)){for(var e=0,n=new Array(t.length);e<t.length;e++)n[e]=t[e];return n}}var o=n("774e"),s=n.n(o),c=n("c8bb"),u=n.n(c);function l(t){if(u()(Object(t))||"[object Arguments]"===Object.prototype.toString.call(t))return s()(t)}function d(){throw new TypeError("Invalid attempt to spread non-iterable instance")}function f(t){return a(t)||l(t)||d()}n.d(e,"default",(function(){return f}))},7700:function(t,e,n){"use strict";n("28a5"),n("20d6"),n("6b54");var i=console.log,r={log:function(t){i(t)},showLoading:function(t,e){uni.showLoading({title:t,mask:e||!1})},hideLoading:function(){uni.hideLoading()},showToast:function(t,e){uni.showToast({title:t,icon:e||"none"})},getPosterUrl:function(t){var e=t.backgroundImage,n=t.type;t.formData;return new Promise((function(t,i){var r;if(e)r=e;else switch(n){case 1:r="";break;default:r="https://www.feiaizn.com/images/20200601172853_loan.png";break}r?t(r):i("背景图片路径不存在")}))},shareTypeListSheetArray:{array:[0,1,2,3,4,5]},isArray:function(t){return"[object Array]"===Object.prototype.toString.call(t)},isObject:function(t){return"[object Object]"===Object.prototype.toString.call(t)},isPromise:function(t){return!!t&&("object"===typeof t||"function"===typeof t)&&"function"===typeof t.then},isNull:function(t){return null===t},isUndefined:function(t){return void 0===t},isUndef:function(t){return void 0===t},isNotNull_string:function(t){return null!==t&&void 0!==t&&""!==t},isFn:function(t){return t&&"function"===typeof t},getStorage:function(t,e,n){uni.getStorage({key:t,success:function(t){t.data&&""!=t.data?e&&e(t.data):n&&n()},fail:function(){n&&n()}})},setStorage:function(t,e){i("设置缓存"),i("key："+t),i("data："+JSON.stringify(e)),uni.setStorage({key:t,data:e})},setStorageSync:function(t,e){uni.setStorageSync(t,e)},getStorageSync:function(t){return uni.getStorageSync(t)},clearStorageSync:function(){uni.clearStorageSync()},removeStorageSync:function(t){uni.removeStorageSync(t)},getImageInfo:function(t,e,n){t=a(t),uni.getImageInfo({src:t,success:function(t){e&&"function"==typeof e&&e(t)},fail:function(t){n&&"function"==typeof n&&n(t)}})},downloadFile:function(t,e){t=a(t),uni.downloadFile({url:t,success:function(t){e&&"function"==typeof e&&e(t)}})},downloadFile_PromiseFc:function(t){return new Promise((function(e,n){"http"!==t.substring(0,4)?e(t):(t=a(t),i("url:"+t),uni.downloadFile({url:t,success:function(t){t&&t.tempFilePath?e(t.tempFilePath):n("not find tempFilePath")},fail:function(t){n(t)}}))}))},saveFile:function(t){uni.saveFile({tempFilePath:t,success:function(t){i("保存成功:"+JSON.stringify(t))}})},downLoadAndSaveFile_PromiseFc:function(t){return new Promise((function(e,n){i("准备下载并保存图片:"+t),"http"===t.substring(0,4)?(t=a(t),uni.downloadFile({url:t,success:function(t){i("下载背景图成功："+JSON.stringify(t)),t&&t.tempFilePath?e(t.tempFilePath):n("not find tempFilePath")},fail:function(t){n(t)}})):e(t)}))},checkFile_PromiseFc:function(t){return new Promise((function(e,n){uni.getSavedFileList({success:function(n){var i=n.fileList,r=i.findIndex((function(e){return e.filePath===t}));e(r)},fail:function(t){n(t)}})}))},removeSavedFile:function(t){uni.getSavedFileList({success:function(e){var n=e.fileList,i=n.findIndex((function(e){return e.filePath===t}));i>=0&&uni.removeSavedFile({filePath:t})}})},fileNameInPath:function(t){var e=t.split("/");return e[e.length-1]},getImageInfo_PromiseFc:function(t){return new Promise((function(e,n){i("准备获取图片信息:"+t),t=a(t),uni.getImageInfo({src:t,success:function(t){i("获取图片信息成功:"+JSON.stringify(t)),e(t)},fail:function(t){i("获取图片信息失败:"+JSON.stringify(t)),n(t)}})}))},previewImage:function(t){"string"==typeof t&&(t=[t]),uni.previewImage({urls:t})},actionSheet:function(t,e){for(var n=[],i=0;i<t.array.length;i++)switch(t.array[i]){case"sinaweibo":n[i]="新浪微博";break;case"qq":n[i]="QQ";break;case"weixin":n[i]="微信";break;case"WXSceneSession":n[i]="微信好友";break;case"WXSenceTimeline":n[i]="微信朋友圈";break;case"WXSceneFavorite":n[i]="微信收藏";break;case 0:n[i]="图文链接";break;case 1:n[i]="纯文字";break;case 2:n[i]="纯图片";break;case 3:n[i]="音乐";break;case 4:n[i]="视频";break;case 5:n[i]="小程序";break;default:break}this.showActionSheet(n,e)},showActionSheet:function(t,e){uni.showActionSheet({itemList:t,success:function(t){e&&"function"==typeof e&&e(t.tapIndex)}})},getProvider:function(t,e,n){var i=this;uni.getProvider({service:t,success:function(r){if(n){var a={};a.array=r.provider,i.actionSheet(a,(function(t){e&&"function"==typeof e&&e(r.provider[t])}))}else if("payment"==t){for(var o=r.provider,s=[],c=0;c<o.length;c++)"wxpay"==o[c]?s[c]={name:"微信支付",value:o[c],img:"/static/image/wei.png"}:"alipay"==o[c]&&(s[c]={name:"支付宝支付",value:o[c],img:"/static/image/ali.png"});e&&"function"==typeof e&&e(s)}else e&&"function"==typeof e&&e(r)}})}};function a(t){return t}t.exports=r},"774e":function(t,e,n){t.exports=n("d2d5")},"7e6e":function(t,e,n){"use strict";function i(t){var e,n,i;return t<128?[t]:t<2048?(e=192+(t>>6),n=128+(63&t),[e,n]):(e=224+(t>>12),n=128+(t>>6&63),i=128+(63&t),[e,n,i])}function r(t){for(var e=[],n=0;n<t.length;n++)for(var r=t.charCodeAt(n),a=i(r),o=0;o<a.length;o++)e.push(a[o]);return e}function a(t,e){this.typeNumber=-1,this.errorCorrectLevel=e,this.modules=null,this.moduleCount=0,this.dataCache=null,this.rsBlocks=null,this.totalDataCount=-1,this.data=t,this.utf8bytes=r(t),this.make()}Object.defineProperty(e,"__esModule",{value:!0}),e.default=a,a.prototype={constructor:a,getModuleCount:function(){return this.moduleCount},make:function(){this.getRightType(),this.dataCache=this.createData(),this.createQrcode()},makeImpl:function(t){this.moduleCount=4*this.typeNumber+17,this.modules=new Array(this.moduleCount);for(var e=0;e<this.moduleCount;e++)this.modules[e]=new Array(this.moduleCount);this.setupPositionProbePattern(0,0),this.setupPositionProbePattern(this.moduleCount-7,0),this.setupPositionProbePattern(0,this.moduleCount-7),this.setupPositionAdjustPattern(),this.setupTimingPattern(),this.setupTypeInfo(!0,t),this.typeNumber>=7&&this.setupTypeNumber(!0),this.mapData(this.dataCache,t)},setupPositionProbePattern:function(t,e){for(var n=-1;n<=7;n++)if(!(t+n<=-1||this.moduleCount<=t+n))for(var i=-1;i<=7;i++)e+i<=-1||this.moduleCount<=e+i||(this.modules[t+n][e+i]=0<=n&&n<=6&&(0==i||6==i)||0<=i&&i<=6&&(0==n||6==n)||2<=n&&n<=4&&2<=i&&i<=4)},createQrcode:function(){for(var t=0,e=0,n=null,i=0;i<8;i++){this.makeImpl(i);var r=c.getLostPoint(this);(0==i||t>r)&&(t=r,e=i,n=this.modules)}this.modules=n,this.setupTypeInfo(!1,e),this.typeNumber>=7&&this.setupTypeNumber(!1)},setupTimingPattern:function(){for(var t=8;t<this.moduleCount-8;t++)null==this.modules[t][6]&&(this.modules[t][6]=t%2==0,null==this.modules[6][t]&&(this.modules[6][t]=t%2==0))},setupPositionAdjustPattern:function(){for(var t=c.getPatternPosition(this.typeNumber),e=0;e<t.length;e++)for(var n=0;n<t.length;n++){var i=t[e],r=t[n];if(null==this.modules[i][r])for(var a=-2;a<=2;a++)for(var o=-2;o<=2;o++)this.modules[i+a][r+o]=-2==a||2==a||-2==o||2==o||0==a&&0==o}},setupTypeNumber:function(t){for(var e=c.getBCHTypeNumber(this.typeNumber),n=0;n<18;n++){var i=!t&&1==(e>>n&1);this.modules[Math.floor(n/3)][n%3+this.moduleCount-8-3]=i,this.modules[n%3+this.moduleCount-8-3][Math.floor(n/3)]=i}},setupTypeInfo:function(t,e){for(var n=o[this.errorCorrectLevel]<<3|e,i=c.getBCHTypeInfo(n),r=0;r<15;r++){var a=!t&&1==(i>>r&1);r<6?this.modules[r][8]=a:r<8?this.modules[r+1][8]=a:this.modules[this.moduleCount-15+r][8]=a;a=!t&&1==(i>>r&1);r<8?this.modules[8][this.moduleCount-r-1]=a:r<9?this.modules[8][15-r-1+1]=a:this.modules[8][15-r-1]=a}this.modules[this.moduleCount-8][8]=!t},createData:function(){var t=new h,e=this.typeNumber>9?16:8;t.put(4,4),t.put(this.utf8bytes.length,e);for(var n=0,i=this.utf8bytes.length;n<i;n++)t.put(this.utf8bytes[n],8);t.length+4<=8*this.totalDataCount&&t.put(0,4);while(t.length%8!=0)t.putBit(!1);while(1){if(t.length>=8*this.totalDataCount)break;if(t.put(a.PAD0,8),t.length>=8*this.totalDataCount)break;t.put(a.PAD1,8)}return this.createBytes(t)},createBytes:function(t){for(var e=0,n=0,i=0,r=this.rsBlock.length/3,a=new Array,o=0;o<r;o++)for(var s=this.rsBlock[3*o+0],u=this.rsBlock[3*o+1],l=this.rsBlock[3*o+2],f=0;f<s;f++)a.push([l,u]);for(var h=new Array(a.length),g=new Array(a.length),p=0;p<a.length;p++){var v=a[p][0],m=a[p][1]-v;n=Math.max(n,v),i=Math.max(i,m),h[p]=new Array(v);for(o=0;o<h[p].length;o++)h[p][o]=255&t.buffer[o+e];e+=v;var b=c.getErrorCorrectPolynomial(m),w=new d(h[p],b.getLength()-1),x=w.mod(b);g[p]=new Array(b.getLength()-1);for(o=0;o<g[p].length;o++){var y=o+x.getLength()-g[p].length;g[p][o]=y>=0?x.get(y):0}}var k=new Array(this.totalDataCount),S=0;for(o=0;o<n;o++)for(p=0;p<a.length;p++)o<h[p].length&&(k[S++]=h[p][o]);for(o=0;o<i;o++)for(p=0;p<a.length;p++)o<g[p].length&&(k[S++]=g[p][o]);return k},mapData:function(t,e){for(var n=-1,i=this.moduleCount-1,r=7,a=0,o=this.moduleCount-1;o>0;o-=2){6==o&&o--;while(1){for(var s=0;s<2;s++)if(null==this.modules[i][o-s]){var u=!1;a<t.length&&(u=1==(t[a]>>>r&1));var l=c.getMask(e,i,o-s);l&&(u=!u),this.modules[i][o-s]=u,r--,-1==r&&(a++,r=7)}if(i+=n,i<0||this.moduleCount<=i){i-=n,n=-n;break}}}}},a.PAD0=236,a.PAD1=17;for(var o=[1,0,3,2],s={PATTERN000:0,PATTERN001:1,PATTERN010:2,PATTERN011:3,PATTERN100:4,PATTERN101:5,PATTERN110:6,PATTERN111:7},c={PATTERN_POSITION_TABLE:[[],[6,18],[6,22],[6,26],[6,30],[6,34],[6,22,38],[6,24,42],[6,26,46],[6,28,50],[6,30,54],[6,32,58],[6,34,62],[6,26,46,66],[6,26,48,70],[6,26,50,74],[6,30,54,78],[6,30,56,82],[6,30,58,86],[6,34,62,90],[6,28,50,72,94],[6,26,50,74,98],[6,30,54,78,102],[6,28,54,80,106],[6,32,58,84,110],[6,30,58,86,114],[6,34,62,90,118],[6,26,50,74,98,122],[6,30,54,78,102,126],[6,26,52,78,104,130],[6,30,56,82,108,134],[6,34,60,86,112,138],[6,30,58,86,114,142],[6,34,62,90,118,146],[6,30,54,78,102,126,150],[6,24,50,76,102,128,154],[6,28,54,80,106,132,158],[6,32,58,84,110,136,162],[6,26,54,82,110,138,166],[6,30,58,86,114,142,170]],G15:1335,G18:7973,G15_MASK:21522,getBCHTypeInfo:function(t){var e=t<<10;while(c.getBCHDigit(e)-c.getBCHDigit(c.G15)>=0)e^=c.G15<<c.getBCHDigit(e)-c.getBCHDigit(c.G15);return(t<<10|e)^c.G15_MASK},getBCHTypeNumber:function(t){var e=t<<12;while(c.getBCHDigit(e)-c.getBCHDigit(c.G18)>=0)e^=c.G18<<c.getBCHDigit(e)-c.getBCHDigit(c.G18);return t<<12|e},getBCHDigit:function(t){var e=0;while(0!=t)e++,t>>>=1;return e},getPatternPosition:function(t){return c.PATTERN_POSITION_TABLE[t-1]},getMask:function(t,e,n){switch(t){case s.PATTERN000:return(e+n)%2==0;case s.PATTERN001:return e%2==0;case s.PATTERN010:return n%3==0;case s.PATTERN011:return(e+n)%3==0;case s.PATTERN100:return(Math.floor(e/2)+Math.floor(n/3))%2==0;case s.PATTERN101:return e*n%2+e*n%3==0;case s.PATTERN110:return(e*n%2+e*n%3)%2==0;case s.PATTERN111:return(e*n%3+(e+n)%2)%2==0;default:throw new Error("bad maskPattern:"+t)}},getErrorCorrectPolynomial:function(t){for(var e=new d([1],0),n=0;n<t;n++)e=e.multiply(new d([1,u.gexp(n)],0));return e},getLostPoint:function(t){for(var e=t.getModuleCount(),n=0,i=0,r=0;r<e;r++)for(var a=0,o=t.modules[r][0],s=0;s<e;s++){var c=t.modules[r][s];if(s<e-6&&c&&!t.modules[r][s+1]&&t.modules[r][s+2]&&t.modules[r][s+3]&&t.modules[r][s+4]&&!t.modules[r][s+5]&&t.modules[r][s+6]&&(s<e-10?t.modules[r][s+7]&&t.modules[r][s+8]&&t.modules[r][s+9]&&t.modules[r][s+10]&&(n+=40):s>3&&t.modules[r][s-1]&&t.modules[r][s-2]&&t.modules[r][s-3]&&t.modules[r][s-4]&&(n+=40)),r<e-1&&s<e-1){var u=0;c&&u++,t.modules[r+1][s]&&u++,t.modules[r][s+1]&&u++,t.modules[r+1][s+1]&&u++,0!=u&&4!=u||(n+=3)}o^c?a++:(o=c,a>=5&&(n+=3+a-5),a=1),c&&i++}for(s=0;s<e;s++)for(a=0,o=t.modules[0][s],r=0;r<e;r++){c=t.modules[r][s];r<e-6&&c&&!t.modules[r+1][s]&&t.modules[r+2][s]&&t.modules[r+3][s]&&t.modules[r+4][s]&&!t.modules[r+5][s]&&t.modules[r+6][s]&&(r<e-10?t.modules[r+7][s]&&t.modules[r+8][s]&&t.modules[r+9][s]&&t.modules[r+10][s]&&(n+=40):r>3&&t.modules[r-1][s]&&t.modules[r-2][s]&&t.modules[r-3][s]&&t.modules[r-4][s]&&(n+=40)),o^c?a++:(o=c,a>=5&&(n+=3+a-5),a=1)}var l=Math.abs(100*i/e/e-50)/5;return n+=10*l,n}},u={glog:function(t){if(t<1)throw new Error("glog("+t+")");return u.LOG_TABLE[t]},gexp:function(t){while(t<0)t+=255;while(t>=256)t-=255;return u.EXP_TABLE[t]},EXP_TABLE:new Array(256),LOG_TABLE:new Array(256)},l=0;l<8;l++)u.EXP_TABLE[l]=1<<l;for(l=8;l<256;l++)u.EXP_TABLE[l]=u.EXP_TABLE[l-4]^u.EXP_TABLE[l-5]^u.EXP_TABLE[l-6]^u.EXP_TABLE[l-8];for(l=0;l<255;l++)u.LOG_TABLE[u.EXP_TABLE[l]]=l;function d(t,e){if(void 0==t.length)throw new Error(t.length+"/"+e);var n=0;while(n<t.length&&0==t[n])n++;this.num=new Array(t.length-n+e);for(var i=0;i<t.length-n;i++)this.num[i]=t[i+n]}d.prototype={get:function(t){return this.num[t]},getLength:function(){return this.num.length},multiply:function(t){for(var e=new Array(this.getLength()+t.getLength()-1),n=0;n<this.getLength();n++)for(var i=0;i<t.getLength();i++)e[n+i]^=u.gexp(u.glog(this.get(n))+u.glog(t.get(i)));return new d(e,0)},mod:function(t){var e=this.getLength(),n=t.getLength();if(e-n<0)return this;for(var i=new Array(e),r=0;r<e;r++)i[r]=this.get(r);while(i.length>=n){var a=u.glog(i[0])-u.glog(t.get(0));for(r=0;r<t.getLength();r++)i[r]^=u.gexp(u.glog(t.get(r))+a);while(0==i[0])i.shift()}return new d(i,0)}};var f=[[1,26,19],[1,26,16],[1,26,13],[1,26,9],[1,44,34],[1,44,28],[1,44,22],[1,44,16],[1,70,55],[1,70,44],[2,35,17],[2,35,13],[1,100,80],[2,50,32],[2,50,24],[4,25,9],[1,134,108],[2,67,43],[2,33,15,2,34,16],[2,33,11,2,34,12],[2,86,68],[4,43,27],[4,43,19],[4,43,15],[2,98,78],[4,49,31],[2,32,14,4,33,15],[4,39,13,1,40,14],[2,121,97],[2,60,38,2,61,39],[4,40,18,2,41,19],[4,40,14,2,41,15],[2,146,116],[3,58,36,2,59,37],[4,36,16,4,37,17],[4,36,12,4,37,13],[2,86,68,2,87,69],[4,69,43,1,70,44],[6,43,19,2,44,20],[6,43,15,2,44,16],[4,101,81],[1,80,50,4,81,51],[4,50,22,4,51,23],[3,36,12,8,37,13],[2,116,92,2,117,93],[6,58,36,2,59,37],[4,46,20,6,47,21],[7,42,14,4,43,15],[4,133,107],[8,59,37,1,60,38],[8,44,20,4,45,21],[12,33,11,4,34,12],[3,145,115,1,146,116],[4,64,40,5,65,41],[11,36,16,5,37,17],[11,36,12,5,37,13],[5,109,87,1,110,88],[5,65,41,5,66,42],[5,54,24,7,55,25],[11,36,12],[5,122,98,1,123,99],[7,73,45,3,74,46],[15,43,19,2,44,20],[3,45,15,13,46,16],[1,135,107,5,136,108],[10,74,46,1,75,47],[1,50,22,15,51,23],[2,42,14,17,43,15],[5,150,120,1,151,121],[9,69,43,4,70,44],[17,50,22,1,51,23],[2,42,14,19,43,15],[3,141,113,4,142,114],[3,70,44,11,71,45],[17,47,21,4,48,22],[9,39,13,16,40,14],[3,135,107,5,136,108],[3,67,41,13,68,42],[15,54,24,5,55,25],[15,43,15,10,44,16],[4,144,116,4,145,117],[17,68,42],[17,50,22,6,51,23],[19,46,16,6,47,17],[2,139,111,7,140,112],[17,74,46],[7,54,24,16,55,25],[34,37,13],[4,151,121,5,152,122],[4,75,47,14,76,48],[11,54,24,14,55,25],[16,45,15,14,46,16],[6,147,117,4,148,118],[6,73,45,14,74,46],[11,54,24,16,55,25],[30,46,16,2,47,17],[8,132,106,4,133,107],[8,75,47,13,76,48],[7,54,24,22,55,25],[22,45,15,13,46,16],[10,142,114,2,143,115],[19,74,46,4,75,47],[28,50,22,6,51,23],[33,46,16,4,47,17],[8,152,122,4,153,123],[22,73,45,3,74,46],[8,53,23,26,54,24],[12,45,15,28,46,16],[3,147,117,10,148,118],[3,73,45,23,74,46],[4,54,24,31,55,25],[11,45,15,31,46,16],[7,146,116,7,147,117],[21,73,45,7,74,46],[1,53,23,37,54,24],[19,45,15,26,46,16],[5,145,115,10,146,116],[19,75,47,10,76,48],[15,54,24,25,55,25],[23,45,15,25,46,16],[13,145,115,3,146,116],[2,74,46,29,75,47],[42,54,24,1,55,25],[23,45,15,28,46,16],[17,145,115],[10,74,46,23,75,47],[10,54,24,35,55,25],[19,45,15,35,46,16],[17,145,115,1,146,116],[14,74,46,21,75,47],[29,54,24,19,55,25],[11,45,15,46,46,16],[13,145,115,6,146,116],[14,74,46,23,75,47],[44,54,24,7,55,25],[59,46,16,1,47,17],[12,151,121,7,152,122],[12,75,47,26,76,48],[39,54,24,14,55,25],[22,45,15,41,46,16],[6,151,121,14,152,122],[6,75,47,34,76,48],[46,54,24,10,55,25],[2,45,15,64,46,16],[17,152,122,4,153,123],[29,74,46,14,75,47],[49,54,24,10,55,25],[24,45,15,46,46,16],[4,152,122,18,153,123],[13,74,46,32,75,47],[48,54,24,14,55,25],[42,45,15,32,46,16],[20,147,117,4,148,118],[40,75,47,7,76,48],[43,54,24,22,55,25],[10,45,15,67,46,16],[19,148,118,6,149,119],[18,75,47,31,76,48],[34,54,24,34,55,25],[20,45,15,61,46,16]];function h(){this.buffer=new Array,this.length=0}a.prototype.getRightType=function(){for(var t=1;t<41;t++){var e=f[4*(t-1)+this.errorCorrectLevel];if(void 0==e)throw new Error("bad rs block @ typeNumber:"+t+"/errorCorrectLevel:"+this.errorCorrectLevel);for(var n=e.length/3,i=0,r=0;r<n;r++){var a=e[3*r+0],o=e[3*r+2];i+=o*a}var s=t>9?2:1;if(this.utf8bytes.length+s<i||40==t){this.typeNumber=t,this.rsBlock=e,this.totalDataCount=i;break}}},h.prototype={get:function(t){var e=Math.floor(t/8);return this.buffer[e]>>>7-t%8&1},put:function(t,e){for(var n=0;n<e;n++)this.putBit(t>>>e-n-1&1)},putBit:function(t){var e=Math.floor(this.length/8);this.buffer.length<=e&&this.buffer.push(0),t&&(this.buffer[e]|=128>>>this.length%8),this.length++}}},"803f":function(t,e,n){var i=n("9134");"string"===typeof i&&(i=[[t.i,i,""]]),i.locals&&(t.exports=i.locals);var r=n("4f06").default;r("6db0fbe2",i,!0,{sourceMap:!1,shadowMode:!1})},"84e5":function(t,e,n){"use strict";var i,r=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("v-uni-view",{staticClass:"promote-goods-box"},[n("v-uni-view",{staticClass:"search"},[n("search",{on:{change:function(e){arguments[0]=e=t.$handleEvent(e),t.searchChange.apply(void 0,arguments)}}})],1),t._l(t.list,(function(e,i){return n("v-uni-view",{key:i,staticClass:"goods",on:{click:function(e){arguments[0]=e=t.$handleEvent(e),t.goodsChange(i)}}},[n("LjlGoodsInfo",{attrs:{infor:e,checked:t.selectedIndex===i}})],1)})),n("v-uni-view",{staticClass:"submit-box"},[n("v-uni-view",{staticClass:"submit",on:{click:function(e){arguments[0]=e=t.$handleEvent(e),t.shareFc()}}},[t._v("立即分享")]),n("v-uni-view",{staticClass:"cancel",on:{click:function(e){arguments[0]=e=t.$handleEvent(e),t.navigateBack.apply(void 0,arguments)}}},[t._v("取消")])],1),n("v-uni-view",{staticClass:"flex_row_c_c modalView",class:t.qrShow?"show":"",on:{click:function(e){arguments[0]=e=t.$handleEvent(e),t.hideQr()}}},[n("v-uni-view",{staticClass:"flex_column"},[n("v-uni-view",{staticClass:"backgroundColor-white padding1vh border_radius_10px"},[n("v-uni-image",{staticClass:"posterImage",attrs:{src:t.poster.finalPath||"",mode:"widthFix"}})],1),n("v-uni-view",{staticClass:"flex_row marginTop2vh"},[n("v-uni-button",{attrs:{type:"primary",size:"mini"},on:{click:function(e){e.preventDefault(),e.stopPropagation(),arguments[0]=e=t.$handleEvent(e),t.saveImage()}}},[t._v("保存图片")]),n("v-uni-button",{attrs:{type:"primary",size:"mini"},on:{click:function(e){e.preventDefault(),e.stopPropagation(),arguments[0]=e=t.$handleEvent(e),t.share()}}},[t._v("分享图片")])],1)],1)],1),n("v-uni-view",{staticClass:"hideCanvasView"},[n("v-uni-canvas",{staticClass:"hideCanvas",style:{width:(t.poster.width||10)+"px",height:(t.poster.height||10)+"px"},attrs:{"canvas-id":"default_PosterCanvasId"}})],1)],2)},a=[];n.d(e,"b",(function(){return r})),n.d(e,"c",(function(){return a})),n.d(e,"a",(function(){return i}))},8605:function(t,e,n){var i=n("24fb");e=i(!1),e.push([t.i,'@charset "UTF-8";\n/* Color\r\n--------------------------*/\n/* distance\r\n--------------------------*/\n/* radius\r\n--------------------------*/\n/**\r\n * 这里是uni-app内置的常用样式变量\r\n *\r\n * uni-app 官方扩展插件及插件市场（https://ext.dcloud.net.cn）上很多三方插件均使用了这些样式变量\r\n * 如果你是插件开发者，建议你使用scss预处理，并在插件代码中直接使用这些变量（无需 import 这个文件），方便用户通过搭积木的方式开发整体风格一致的App\r\n *\r\n */\n/**\r\n * 如果你是App开发者（插件使用者），你可以通过修改这些变量来定制自己的插件主题，实现自定义主题功能\r\n *\r\n * 如果你的项目同样使用了scss预处理，你也可以直接在你的 scss 代码中使用如下变量，同时无需 import 这个文件\r\n */\n/* 颜色变量 */\n/* 行为相关颜色 */\n/* 文字基本颜色 */\n/* 背景颜色 */\n/* 边框颜色 */\n/* 尺寸变量 */\n/* 文字尺寸 */\n/* 图片尺寸 */\n/* Border Radius */\n/* 水平间距 */\n/* 垂直间距 */\n/* 透明度 */\n/* 文章场景相关 */uni-page-body[data-v-6d182d4e]{background:#fff}.promote-goods-box[data-v-6d182d4e]{box-sizing:border-box;padding:0 %?24?%}.promote-goods-box > uni-view[data-v-6d182d4e]{padding:%?20?% 0}.promote-goods-box .goods + .goods[data-v-6d182d4e]{border-top:%?1?% solid #eee}.promote-goods-box .submit-box[data-v-6d182d4e]{position:fixed;bottom:%?20?%;color:#fff;font-size:%?36?%;width:calc(100% - %?48?%)}.promote-goods-box .submit-box uni-view[data-v-6d182d4e]{width:100%;height:%?100?%;border:%?1?% solid #eee;text-align:center;line-height:%?100?%}.promote-goods-box .submit-box uni-view[data-v-6d182d4e]:nth-child(1){background-color:#fad64c;margin-bottom:%?12?%}.promote-goods-box .submit-box uni-view[data-v-6d182d4e]:nth-child(2){color:#333}.hideCanvasView[data-v-6d182d4e]{position:relative}.hideCanvas[data-v-6d182d4e]{position:fixed;top:%?-99999?%;left:%?-99999?%;z-index:-99999}.flex_row_c_c[data-v-6d182d4e]{display:-webkit-box;display:-webkit-flex;display:flex;-webkit-box-orient:horizontal;-webkit-box-direction:normal;-webkit-flex-direction:row;flex-direction:row;-webkit-box-pack:center;-webkit-justify-content:center;justify-content:center;-webkit-box-align:center;-webkit-align-items:center;align-items:center}.modalView[data-v-6d182d4e]{width:100%;height:100%;position:fixed;top:0;left:0;right:0;bottom:0;opacity:0;outline:0;-webkit-transform:scale(1.2);transform:scale(1.2);-webkit-perspective:%?2500?%;perspective:%?2500?%;background:rgba(0,0,0,.6);-webkit-transition:all .3s ease-in-out;transition:all .3s ease-in-out;pointer-events:none;-webkit-backface-visibility:hidden;backface-visibility:hidden;z-index:999}.modalView.show[data-v-6d182d4e]{opacity:1;-webkit-transform:scale(1);transform:scale(1);pointer-events:auto}.flex_column[data-v-6d182d4e]{display:-webkit-box;display:-webkit-flex;display:flex;-webkit-box-orient:vertical;-webkit-box-direction:normal;-webkit-flex-direction:column;flex-direction:column}.backgroundColor-white[data-v-6d182d4e]{background-color:#fff}.border_radius_10px[data-v-6d182d4e]{border-radius:10px}.padding1vh[data-v-6d182d4e]{padding:1vh}.posterImage[data-v-6d182d4e]{width:60vw}.flex_row[data-v-6d182d4e]{display:-webkit-box;display:-webkit-flex;display:flex;-webkit-box-orient:horizontal;-webkit-box-direction:normal;-webkit-flex-direction:row;flex-direction:row}.marginTop2vh[data-v-6d182d4e]{margin-top:2vh}body.?%PAGE?%[data-v-6d182d4e]{background:#fff}',""]),t.exports=e},9134:function(t,e,n){var i=n("24fb");e=i(!1),e.push([t.i,'@charset "UTF-8";\n/* Color\r\n--------------------------*/\n/* distance\r\n--------------------------*/\n/* radius\r\n--------------------------*/\n/**\r\n * 这里是uni-app内置的常用样式变量\r\n *\r\n * uni-app 官方扩展插件及插件市场（https://ext.dcloud.net.cn）上很多三方插件均使用了这些样式变量\r\n * 如果你是插件开发者，建议你使用scss预处理，并在插件代码中直接使用这些变量（无需 import 这个文件），方便用户通过搭积木的方式开发整体风格一致的App\r\n *\r\n */\n/**\r\n * 如果你是App开发者（插件使用者），你可以通过修改这些变量来定制自己的插件主题，实现自定义主题功能\r\n *\r\n * 如果你的项目同样使用了scss预处理，你也可以直接在你的 scss 代码中使用如下变量，同时无需 import 这个文件\r\n */\n/* 颜色变量 */\n/* 行为相关颜色 */\n/* 文字基本颜色 */\n/* 背景颜色 */\n/* 边框颜色 */\n/* 尺寸变量 */\n/* 文字尺寸 */\n/* 图片尺寸 */\n/* Border Radius */\n/* 水平间距 */\n/* 垂直间距 */\n/* 透明度 */\n/* 文章场景相关 */.search-box[data-v-370d9227]{position:relative;width:100%;height:%?60?%;background:#f2f2f2}.search-box .icon[data-v-370d9227]{width:%?28?%;height:%?28?%;position:absolute;left:%?20?%;top:%?15?%;font-size:1em}.search-box uni-input[data-v-370d9227]{width:100%;height:100%;box-sizing:border-box;padding:%?7?% %?60?%;font-size:%?26?%}.search-box .placeholder-class[data-v-370d9227]{line-height:%?60?%}',""]),t.exports=e},9533:function(t,e,n){"use strict";var i=n("e135"),r=n.n(i);r.a},"95d5":function(t,e,n){var i=n("40c3"),r=n("5168")("iterator"),a=n("481b");t.exports=n("584a").isIterable=function(t){var e=Object(t);return void 0!==e[r]||"@@iterator"in e||a.hasOwnProperty(i(e))}},"96e6":function(t,e,n){"use strict";var i=n("4ea4");Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0,n("7514"),n("96cf");var r,a=i(n("3b8d")),o=i(n("b15a")),s=i(n("5d64")),c=i(n("3cf0")),u=n("9d8f"),l=i(n("c214")),d=i(n("edbb")),f=n("4148"),h=n("6e47"),g=i(n("7700")),p=n("e15e"),v={data:function(){return{selectedIndex:0,list:[],listQuery:{page:1,size:5,type:2},shareConfig:{},deliveryFlag:!1,canvasFlag:!0,posterData:{},poster:{},qrShow:!1,canvasId:"default_PosterCanvasId",code:""}},onLoad:function(){var t=(0,a.default)(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return r=this,t.next=3,this.getList();case 3:case"end":return t.stop()}}),t,this)})));function e(){return t.apply(this,arguments)}return e}(),onShow:function(){},methods:{createCanvasImageEvn:function(){var t=this;this.$forceUpdate(),setTimeout((function(){t.canvasFlag=!1,t.deliveryFlag=!1,t.$refs.hchPoster.createCanvasImage()}),500)},shareEvn:function(){this.deliveryFlag=!0},closeShareEvn:function(){this.deliveryFlag=!1},canvasCancel:function(t){this.canvasFlag=t},saveToAlbum:function(){var t=(0,a.default)(regeneratorRuntime.mark((function t(){var e;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return r.userInfo=(0,f.getStorage)("userInfo"),e=r.userInfo.id,console.log(e),t.next=5,(0,h.getUnlimited)({scene:e,width:600});case 5:r.code=t.sent;case 6:case"end":return t.stop()}}),t)})));function e(){return t.apply(this,arguments)}return e}(),goodsChange:function(t){this.selectedIndex=t,this.setShareConfig()},searchChange:function(t){console.log("搜索")},navigateBack:function(){uni.navigateBack({delta:1})},getList:function(){var t=(0,a.default)(regeneratorRuntime.mark((function t(){var e,n,i,r=this;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,this.saveToAlbum();case 2:return t.next=4,(0,u.getGoodsList)(this.listQuery);case 4:for(e=t.sent.list,n=0,e.map(function(){var t=(0,a.default)(regeneratorRuntime.mark((function t(e){var i;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,(0,u.getGoodsDetail)({id:e.uuid});case 2:i=t.sent.showimg[0].url,console.log(i),r.list.push({id:e.uuid,url:i,name:e.name,price:e.price,originalPrice:e.originalPrice}),0==n&&(r.posterData={url:i,icon:"https://www.feiaizn.com/images/20200515115542_zhehoujia.png",title:e.name,discountPrice:e.price,orignPrice:e.originalPrice,code:r.code},n++);case 6:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}()),console.log(this.list),i=0;i++;i<this.list.length);this.$forceUpdate();case 10:case"end":return t.stop()}}),t,this)})));function e(){return t.apply(this,arguments)}return e}(),setShareConfig:function(){var t=(0,a.default)(regeneratorRuntime.mark((function t(){var e;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:e=this.list[this.selectedIndex],this.posterData={url:e.url,icon:"https://www.feiaizn.com/images/20200515115542_zhehoujia.png",title:e.name,discountPrice:e.price,orignPrice:e.originalPrice,code:this.code},this.$forceUpdate();case 3:case"end":return t.stop()}}),t,this)})));function e(){return t.apply(this,arguments)}return e}(),shareFc:function(){var t=(0,a.default)(regeneratorRuntime.mark((function t(){var e,n=this;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return console.log(this.posterData),t.prev=1,console.log("准备生成:"+new Date),t.next=5,(0,p.getSharePoster)({_this:this,type:"testShareType",formData:{},posterCanvasId:this.canvasId,delayTimeScale:20,backgroundImage:this.posterData.url,drawArray:function(t){var e=t.bgObj,i=(t.type,t.bgScale,.3*e.width),r=.045*e.width,a=.04*e.height;return new Promise((function(t,o){t([{type:"custom",setDraw:function(t){t.setFillStyle("black"),t.setGlobalAlpha(.3),t.fillRect(0,e.height-.2*e.height,e.width,.2*e.height),t.setGlobalAlpha(1)}},{type:"image",url:n.posterData.code,alpha:1,dx:i,dy:e.height-.45*e.width,infoCallBack:function(t){var n=.2*e.width/t.height;return{circleSet:{x:t.width*n*2/2,y:.2*e.width*2/2,r:.2*e.width*2/2},dWidth:t.width*n*2,dHeight:.2*e.width*2}}},{type:"text",fontStyle:"italic",text:n.posterData.code,size:r,color:"white",alpha:.5,textAlign:"left",textBaseline:"middle",infoCallBack:function(t){return g.default.log("index页面的text的infocallback ，textlength:"+t),{dx:e.width-t-r,dy:e.height-3*a}},serialNum:0,id:"tag1"},{type:"text",text:n.posterData.orignPrice,fontWeight:"bold",size:r,color:"white",alpha:.75,textAlign:"left",textBaseline:"middle",serialNum:1,allInfoCallback:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},e=t.drawArray,n=e.find((function(t){return"tag1"===t.id}));return new Promise((function(t,e){setTimeout((function(){t({dx:n.dx,dy:n.dy+a})}),1)}))}},{type:"text",text:"原价"+n.posterData.orignPrice,size:r,color:"white",alpha:1,textAlign:"left",textBaseline:"middle",infoCallBack:function(t){return{dx:e.width-t-r,dy:e.height-a-100}}},{type:"text",text:"现价"+n.posterData.discountPrice,size:r,color:"white",alpha:1,textAlign:"left",textBaseline:"middle",infoCallBack:function(t){return{dx:e.width-t-r-60,dy:e.height-a-60}}},{type:"qrcode",text:"原价:你好，我是取舍",size:80,dx:.05*e.width,dy:380}])}))},setCanvasWH:function(t){var e=t.bgObj;t.type,t.bgScale;n.poster=e}});case 5:e=t.sent,console.log("海报生成成功, 时间:"+new Date+"， 临时路径: "+e.poster.tempFilePath),this.poster.finalPath=e.poster.tempFilePath,this.qrShow=!0,t.next=16;break;case 11:t.prev=11,t.t0=t["catch"](1),g.default.hideLoading(),g.default.showToast(JSON.stringify(t.t0)),console.log(JSON.stringify(t.t0));case 16:case"end":return t.stop()}}),t,this,[[1,11]])})));function e(){return t.apply(this,arguments)}return e}(),saveImage:function(){g.default.showToast("保存了")},share:function(){g.default.showToast("分享了")},hideQr:function(){this.qrShow=!1}},components:{Search:o.default,LjlGoodsInfo:s.default,ShareCanvas:c.default,hchPoster:l.default,tkiQrcode:d.default}};e.default=v},9933:function(t,e,n){"use strict";var i=n("db03"),r=n.n(i);r.a},"9d8f":function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.getGoodsList=a,e.getGoodsDetail=o,e.getGoodsEvaluation=s,e.getGoodsConvert=c;var i=n("133c"),r=n("e2a7");function a(t){return(0,i.request)({method:"GET",url:r.LOAD_GOODS_LIST,showSuccessToast:!0,data:t})}function o(t){return(0,i.request)({method:"GET",url:r.LOAD_GOODS_DETAIL,showSuccessToast:!0,data:t})}function s(t){return(0,i.request)({method:"GET",url:r.LOAD_GOODS_EVALUATION,showSuccessToast:!0,data:t})}function c(t){var e=t.id,n=t.page,a=t.size;return(0,i.request)({url:"".concat(r.LOAD_GOODS_CONVERT,"?id=").concat(e,"&page=").concat(n,"&size=").concat(a),showSuccessToast:!0})}},a745:function(t,e,n){t.exports=n("f410")},b15a:function(t,e,n){"use strict";n.r(e);var i=n("40b9"),r=n("da14");for(var a in r)"default"!==a&&function(t){n.d(e,t,(function(){return r[t]}))}(a);n("487b1");var o,s=n("f0c5"),c=Object(s["a"])(r["default"],i["b"],i["c"],!1,null,"370d9227",null,!1,i["a"],o);e["default"]=c.exports},b50c:function(t,e,n){"use strict";n.r(e);var i=n("6d67"),r=n.n(i);for(var a in i)"default"!==a&&function(t){n.d(e,t,(function(){return i[t]}))}(a);e["default"]=r.a},b5b1:function(t,e,n){var i=n("24fb");e=i(!1),e.push([t.i,'@charset "UTF-8";\n/* Color\r\n--------------------------*/\n/* distance\r\n--------------------------*/\n/* radius\r\n--------------------------*/\n/**\r\n * 这里是uni-app内置的常用样式变量\r\n *\r\n * uni-app 官方扩展插件及插件市场（https://ext.dcloud.net.cn）上很多三方插件均使用了这些样式变量\r\n * 如果你是插件开发者，建议你使用scss预处理，并在插件代码中直接使用这些变量（无需 import 这个文件），方便用户通过搭积木的方式开发整体风格一致的App\r\n *\r\n */\n/**\r\n * 如果你是App开发者（插件使用者），你可以通过修改这些变量来定制自己的插件主题，实现自定义主题功能\r\n *\r\n * 如果你的项目同样使用了scss预处理，你也可以直接在你的 scss 代码中使用如下变量，同时无需 import 这个文件\r\n */\n/* 颜色变量 */\n/* 行为相关颜色 */\n/* 文字基本颜色 */\n/* 背景颜色 */\n/* 边框颜色 */\n/* 尺寸变量 */\n/* 文字尺寸 */\n/* 图片尺寸 */\n/* Border Radius */\n/* 水平间距 */\n/* 垂直间距 */\n/* 透明度 */\n/* 文章场景相关 */.content[data-v-5bf69e94]{text-align:center;height:100%}.canvas_box .canvas_box_mask[data-v-5bf69e94]{width:100%;height:100%;position:fixed;top:0;right:0;bottom:0;left:0;background:rgba(0,0,0,.5);z-index:9}.canvas_box .canvas[data-v-5bf69e94]{position:fixed!important;top:0!important;left:0!important;display:block!important;width:100%!important;height:100%!important;z-index:9}.canvas_box .button-wrapper[data-v-5bf69e94]{width:%?320?%;height:%?72?%;position:absolute;bottom:%?20?%;left:%?215?%;z-index:16}.canvas_box .save_btn[data-v-5bf69e94]{font-size:%?30?%;line-height:%?72?%;color:#fff;width:100%;height:100%;text-align:center;border-radius:%?45?%;border-radius:%?36?%;z-index:10}.canvas_box .canvas_close_btn[data-v-5bf69e94]{position:fixed;top:%?30?%;right:0;z-index:12}',""]),t.exports=e},b6c2:function(t,e,n){"use strict";n.r(e);var i=n("4a8f"),r=n.n(i);for(var a in i)"default"!==a&&function(t){n.d(e,t,(function(){return i[t]}))}(a);e["default"]=r.a},c214:function(t,e,n){"use strict";n.r(e);var i=n("caa9"),r=n("b50c");for(var a in r)"default"!==a&&function(t){n.d(e,t,(function(){return r[t]}))}(a);n("9933");var o,s=n("f0c5"),c=Object(s["a"])(r["default"],i["b"],i["c"],!1,null,"5bf69e94",null,!1,i["a"],o);e["default"]=c.exports},c8bb:function(t,e,n){t.exports=n("54a1")},caa9:function(t,e,n){"use strict";var i,r=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("v-uni-view",{staticClass:"canvas_box",attrs:{hidden:t.canvasFlag}},[n("v-uni-view",{staticClass:"canvas_box_mask"}),n("v-uni-icon",{staticClass:"canvas_close_btn",attrs:{type:"cancel",size:"60",color:"transparent"},on:{click:function(e){arguments[0]=e=t.$handleEvent(e),t.canvasCancelEvn.apply(void 0,arguments)}}}),n("v-uni-view",{staticClass:"button-wrapper"},[n("v-uni-cover-view",{staticClass:"save_btn",on:{click:function(e){arguments[0]=e=t.$handleEvent(e),t.saveCanvasImage.apply(void 0,arguments)}}})],1)],1)},a=[];n.d(e,"b",(function(){return r})),n.d(e,"c",(function(){return a})),n.d(e,"a",(function(){return i}))},cae9:function(t,e,n){var i=n("24fb");e=i(!1),e.push([t.i,'@charset "UTF-8";\n/* Color\r\n--------------------------*/\n/* distance\r\n--------------------------*/\n/* radius\r\n--------------------------*/\n/**\r\n * 这里是uni-app内置的常用样式变量\r\n *\r\n * uni-app 官方扩展插件及插件市场（https://ext.dcloud.net.cn）上很多三方插件均使用了这些样式变量\r\n * 如果你是插件开发者，建议你使用scss预处理，并在插件代码中直接使用这些变量（无需 import 这个文件），方便用户通过搭积木的方式开发整体风格一致的App\r\n *\r\n */\n/**\r\n * 如果你是App开发者（插件使用者），你可以通过修改这些变量来定制自己的插件主题，实现自定义主题功能\r\n *\r\n * 如果你的项目同样使用了scss预处理，你也可以直接在你的 scss 代码中使用如下变量，同时无需 import 这个文件\r\n */\n/* 颜色变量 */\n/* 行为相关颜色 */\n/* 文字基本颜色 */\n/* 背景颜色 */\n/* 边框颜色 */\n/* 尺寸变量 */\n/* 文字尺寸 */\n/* 图片尺寸 */\n/* Border Radius */\n/* 水平间距 */\n/* 垂直间距 */\n/* 透明度 */\n/* 文章场景相关 */.canvas_box[data-v-c50793d0]{position:fixed;top:%?0?%;left:%?0?%;right:%?0?%;bottom:%?0?%;display:-webkit-box;display:-webkit-flex;display:flex;-webkit-box-pack:center;-webkit-justify-content:center;justify-content:center;-webkit-box-align:center;-webkit-align-items:center;align-items:center;background-color:rgba(0,0,0,.7);z-index:999}.canvas_box uni-canvas[data-v-c50793d0]{-webkit-transform:translateY(-10%);transform:translateY(-10%);background-color:#fffffb}.share_set[data-v-c50793d0]{position:fixed;left:%?0?%;right:%?0?%;bottom:%?0?%;height:%?200?%;display:-webkit-box;display:-webkit-flex;display:flex;-webkit-box-pack:center;-webkit-justify-content:center;justify-content:center}.share_option[data-v-c50793d0]{width:33%;height:100%;display:-webkit-box;display:-webkit-flex;display:flex;-webkit-box-orient:vertical;-webkit-box-direction:normal;-webkit-flex-direction:column;flex-direction:column;-webkit-box-pack:center;-webkit-justify-content:center;justify-content:center;-webkit-box-align:center;-webkit-align-items:center;align-items:center}.share_option > uni-image[data-v-c50793d0]{width:%?100?%;height:%?100?%}.share_option > uni-text[data-v-c50793d0]{font-size:%?24?%;color:#fffffb;margin-top:%?10?%}.under_button[data-v-c50793d0]{background-color:initial;height:%?100?%;position:fixed;bottom:%?30?%;width:80%;color:#fffffb}',""]),t.exports=e},d2d5:function(t,e,n){n("1654"),n("549b"),t.exports=n("584a").Array.from},d771:function(t,e,n){"use strict";n.r(e);var i=n("84e5"),r=n("2ebd");for(var a in r)"default"!==a&&function(t){n.d(e,t,(function(){return r[t]}))}(a);n("52ce");var o,s=n("f0c5"),c=Object(s["a"])(r["default"],i["b"],i["c"],!1,null,"6d182d4e",null,!1,i["a"],o);e["default"]=c.exports},da14:function(t,e,n){"use strict";n.r(e);var i=n("3056"),r=n.n(i);for(var a in i)"default"!==a&&function(t){n.d(e,t,(function(){return i[t]}))}(a);e["default"]=r.a},db03:function(t,e,n){var i=n("b5b1");"string"===typeof i&&(i=[[t.i,i,""]]),i.locals&&(t.exports=i.locals);var r=n("4f06").default;r("5bdcebdf",i,!0,{sourceMap:!1,shadowMode:!1})},dbce:function(t,e){function n(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var n in t)if(Object.prototype.hasOwnProperty.call(t,n)){var i=Object.defineProperty&&Object.getOwnPropertyDescriptor?Object.getOwnPropertyDescriptor(t,n):{};i.get||i.set?Object.defineProperty(e,n,i):e[n]=t[n]}return e.default=t,e}t.exports=n},e135:function(t,e,n){var i=n("cae9");"string"===typeof i&&(i=[[t.i,i,""]]),i.locals&&(t.exports=i.locals);var r=n("4f06").default;r("075a6c21",i,!0,{sourceMap:!1,shadowMode:!1})},e15e:function(t,e,n){"use strict";var i=n("4ea4");n("8e6e"),n("456d"),n("6c7b"),n("28a5"),n("ac6a"),n("c5f6"),n("55dd");var r=i(n("75fc")),a=i(n("bd86"));n("96cf");var o=i(n("3b8d")),s=i(n("7700")),c=i(n("7e6e"));function u(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(t);e&&(i=i.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,i)}return n}function l(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?u(Object(n),!0).forEach((function(e){(0,a.default)(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):u(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}var d="ShrePosterBackground_",f="QSSHAREPOSTER_IDKEY";function h(t){return new Promise(function(){var e=(0,o.default)(regeneratorRuntime.mark((function e(n,i){var r,a;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,g(t);case 3:r=e.sent,n(r),e.next=21;break;case 7:return e.prev=7,e.t0=e["catch"](0),L(t.type),e.prev=10,s.default.log("------------清除缓存后, 开始第二次尝试------------"),e.next=14,g(t);case 14:a=e.sent,n(a),e.next=21;break;case 18:e.prev=18,e.t1=e["catch"](10),i(e.t1);case 21:case"end":return e.stop()}}),e,null,[[0,7],[10,18]])})));return function(t,n){return e.apply(this,arguments)}}())}function g(t){var e=t.type,n=t.formData,i=t.background,a=t.posterCanvasId,c=t.backgroundImage,u=t.reserve,d=t.textArray,h=t.drawArray,g=t.qrCodeArray,m=t.imagesArray,b=t.setCanvasWH,w=t.setCanvasToTempFilePath,y=t.setDraw,k=t.bgScale,S=t.Context,C=t._this,P=t.delayTimeScale,T=t.drawDelayTime;return new Promise(function(){var t=(0,o.default)(regeneratorRuntime.mark((function t(o,I){var A,O,_,E,L,F,D,R,j,z,W,B,M;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(t.prev=0,s.default.showLoading("正在准备海报数据"),S||(s.default.log("没有画布对象,创建画布对象"),S=uni.createCanvasContext(a,C||null)),!(i&&i.width&&i.height)){t.next=7;break}A=i,t.next=10;break;case 7:return t.next=9,N({backgroundImage:c,type:e,formData:n});case 9:A=t.sent;case 10:if(k=k||.75,A.width=A.width*k,A.height=A.height*k,s.default.log("获取背景图信息对象成功:"+JSON.stringify(A)),O={bgObj:A,type:e,bgScale:k},!b||"function"!=typeof b){t.next=18;break}return t.next=18,new Promise((function(t,e){b(O),setTimeout((function(){t()}),0)}));case 18:if(!m){t.next=26;break}return"function"==typeof m&&(m=m(O)),s.default.showLoading("正在生成需绘制图片的临时路径"),s.default.log("准备设置图片"),t.next=24,x(m);case 24:m=t.sent,s.default.hideLoading();case 26:if(d&&("function"==typeof d&&(d=d(O)),d=v(S,d)),!g){t.next=41;break}"function"==typeof g&&(g=g(O)),s.default.showLoading("正在生成需绘制图片的临时路径"),_=0;case 31:if(!(_<g.length)){t.next=40;break}if(s.default.log(_),!g[_].image){t.next=37;break}return t.next=36,s.default.downloadFile_PromiseFc(g[_].image);case 36:g[_].image=t.sent;case 37:_++,t.next=31;break;case 40:s.default.hideLoading();case 41:if(!h){t.next=98;break}if("function"==typeof h&&(h=h(O)),!s.default.isPromise(h)){t.next=47;break}return t.next=46,h;case 46:h=t.sent;case 47:if(!(s.default.isArray(h)&&h.length>0)){t.next=98;break}E=!1,L=0;case 50:if(!(L<h.length)){t.next=78;break}F=h[L],s.default.isFn(F.allInfoCallback)&&!E&&(E=!0),F[f]=L,D=void 0,t.t0=F.type,t.next="image"===t.t0?58:"text"===t.t0?62:"qrcode"===t.t0?64:"custom"===t.t0?70:71;break;case 58:return t.next=60,x(F);case 60:return D=t.sent,t.abrupt("break",73);case 62:return D=v(S,F),t.abrupt("break",73);case 64:if(!F.image){t.next=69;break}return t.next=67,s.default.downloadFile_PromiseFc(F.image);case 67:t.t1=t.sent,D={image:t.t1};case 69:return t.abrupt("break",73);case 70:return t.abrupt("break",73);case 71:return s.default.log("未识别的类型"),t.abrupt("break",73);case 73:D&&s.default.isObject(D)&&(h[L]=l({},F,{},D));case 75:L++,t.next=50;break;case 78:if(!E){t.next=98;break}s.default.log("----------------hasAllInfoCallback----------------"),R=(0,r.default)(h),R.sort((function(t,e){var n=s.default.isUndef(t.serialNum)||s.default.isNull(t.serialNum)?Number.NEGATIVE_INFINITY:Number(t.serialNum),i=s.default.isUndef(e.serialNum)||s.default.isNull(e.serialNum)?Number.NEGATIVE_INFINITY:Number(e.serialNum);return n-i})),s.default.log("开始for循环"),j=0;case 84:if(!(j<R.length)){t.next=97;break}if(z=l({},R[j]),!s.default.isFn(z.allInfoCallback)){t.next=94;break}if(W=z.allInfoCallback({drawArray:R}),!s.default.isPromise(W)){t.next=92;break}return t.next=91,W;case 91:W=t.sent;case 92:B=z[f],s.default.isUndef(B)?console.log("程序错误 找不到idKey!!!\t...这不应该啊"):h[z[f]]=l({},z,{},W);case 94:j++,t.next=84;break;case 97:s.default.log("for循环结束");case 98:return t.next=100,p({Context:S,type:e,posterCanvasId:a,reserve:u,drawArray:h,textArray:d,imagesArray:m,bgObj:A,qrCodeArray:g,setCanvasToTempFilePath:w,setDraw:y,bgScale:k,_this:C,delayTimeScale:P,drawDelayTime:T});case 100:M=t.sent,s.default.hideLoading(),o({bgObj:A,poster:M,type:e}),t.next=108;break;case 105:t.prev=105,t.t2=t["catch"](0),I(t.t2);case 108:case"end":return t.stop()}}),t,null,[[0,105]])})));return function(e,n){return t.apply(this,arguments)}}())}function p(t){var e=t.Context,n=t.type,i=t.posterCanvasId,r=t.reserve,a=t.bgObj,o=t.drawArray,c=t.textArray,u=t.qrCodeArray,l=t.imagesArray,d=t.setCanvasToTempFilePath,f=t.setDraw,h=t.bgScale,g=(t._this,t.delayTimeScale),p=t.drawDelayTime,v={Context:e,bgObj:a,type:n,bgScale:h};return g=void 0!==g?g:15,p=void 0!==p?p:100,new Promise((function(t,h){try{if(s.default.showLoading("正在绘制海报"),s.default.log("背景对象:"+JSON.stringify(a)),a&&a.path?(s.default.log("背景有图片路径"),e.drawImage(a.path,0,0,a.width,a.height)):(s.default.log("背景没有图片路径"),a.backgroundColor?(s.default.log("背景有背景颜色:"+a.backgroundColor),e.setFillStyle(a.backgroundColor),e.fillRect(0,0,a.width,a.height)):s.default.log("背景没有背景颜色")),s.default.showLoading("绘制图片"),l&&l.length>0&&T(e,l),s.default.showLoading("绘制自定义内容"),f&&"function"==typeof f&&f(v),s.default.showLoading("绘制文本"),c&&c.length>0&&k(e,c,a),s.default.showLoading("绘制二维码"),u&&u.length>0)for(var m=0;m<u.length;m++)E(e,u[m]);if(s.default.showLoading("绘制可控层级序列"),o&&o.length>0)for(var b=0;b<o.length;b++){var w=o[b];switch(s.default.log("绘制可控层级序列, drawArrayItem:"+JSON.stringify(w)),w.type){case"image":s.default.log("绘制可控层级序列, 绘制图片"),T(e,w);break;case"text":s.default.log("绘制可控层级序列, 绘制文本"),k(e,w,a);break;case"custom":s.default.log("绘制可控层级序列, 绘制自定义内容"),w.setDraw&&"function"===typeof w.setDraw&&w.setDraw(e);break;default:s.default.log("未识别的类型");break}}s.default.showLoading("绘制中"),setTimeout((function(){s.default.log("准备执行draw方法"),s.default.log("Context:"+e);var f=function(){s.default.showLoading("正在输出图片");var e,r=d||{};r&&"function"==typeof r&&(r=d(a,n)),e=function(){s.default.hideLoading(),t({tempFilePath:document.querySelector("uni-canvas[canvas-id=".concat(i,"]>canvas")).toDataURL("image/jpeg",r.quality||.8)})};var f=0;u&&u.forEach((function(t){t.text&&(f+=Number(t.text.length))})),l&&l.forEach((function(){f+=g})),c&&c.forEach((function(){f+=g})),o&&o.forEach((function(t){switch(t.type){case"text":t.text&&(f+=t.text.length);break;default:f+=g;break}})),s.default.log("延时系数:"+g),s.default.log("总计延时:"+f),setTimeout(e,f)};e.draw("boolean"==typeof r&&r,f)}),p)}catch(x){s.default.hideLoading(),h(x)}}))}function v(t,e){if(s.default.log("进入设置文字方法, texts:"+JSON.stringify(e)),e&&s.default.isArray(e)){if(s.default.log("texts是数组"),e.length>0)for(var n=0;n<e.length;n++)s.default.log("字符串信息-初始化之前:"+JSON.stringify(e[n])),e[n]=m(t,e[n])}else s.default.log("texts是对象"),e=m(t,e);return s.default.log("返回texts:"+JSON.stringify(e)),e}function m(t,e){if(s.default.log("进入设置文字方法, textItem:"+JSON.stringify(e)),s.default.isNotNull_string(e.text)){e.text=String(e.text),e.alpha=void 0!==e.alpha?e.alpha:1,e.color=e.color||"black",e.size=void 0!==e.size?e.size:10,e.textAlign=e.textAlign||"left",e.textBaseline=e.textBaseline||"middle",e.dx=e.dx||0,e.dy=e.dy||0,e.size=Math.ceil(Number(e.size)),s.default.log("字符串信息-初始化默认值后:"+JSON.stringify(e));var n=b(t,{text:e.text,size:e.size});s.default.log("字符串信息-初始化时的文本长度:"+n);var i={};e.infoCallBack&&"function"===typeof e.infoCallBack&&(i=e.infoCallBack(n)),e=l({},e,{textLength:n},i),s.default.log("字符串信息-infoCallBack后:"+JSON.stringify(e))}return e}function b(t,e){s.default.log("计算文字长度, obj:"+JSON.stringify(e));var n,i=e.text,r=e.size;if(t.setFontSize(r),n={},s.default.log("measureText计算文字长度, textLength:"+JSON.stringify(n)),n=n&&n.width?n.width:0,!n){for(var a=0,o=0;o<i.length;o++){var c=i.substr(o,1),u=w(c);s.default.log("计算文字宽度系数:"+u),a+=u}s.default.log("文字宽度总系数:"+a),n=a*r}return n}function w(t){var e;return e=/a/.test(t)?.552734375:/b/.test(t)?.638671875:/c/.test(t)?.50146484375:/d/.test(t)?.6396484375:/e/.test(t)?.5673828125:/f/.test(t)?.3466796875:/g/.test(t)?.6396484375:/h/.test(t)?.61572265625:/i/.test(t)?.26611328125:/j/.test(t)?.26708984375:/k/.test(t)?.54443359375:/l/.test(t)?.26611328125:/m/.test(t)?.93701171875:/n/.test(t)?.6162109375:/o/.test(t)?.6357421875:/p/.test(t)?.638671875:/q/.test(t)?.6396484375:/r/.test(t)?.3818359375:/s/.test(t)?.462890625:/t/.test(t)?.37255859375:/u/.test(t)?.6162109375:/v/.test(t)?.52490234375:/w/.test(t)?.78955078125:/x/.test(t)?.5068359375:/y/.test(t)?.529296875:/z/.test(t)?.49169921875:/A/.test(t)?.70361328125:/B/.test(t)?.62744140625:/C/.test(t)?.6689453125:/D/.test(t)?.76171875:/E/.test(t)?.5498046875:/F/.test(t)?.53125:/G/.test(t)?.74365234375:/H/.test(t)?.7734375:/I/.test(t)?.2939453125:/J/.test(t)?.39599609375:/K/.test(t)?.634765625:/L/.test(t)?.51318359375:/M/.test(t)?.97705078125:/N/.test(t)?.81298828125:/O/.test(t)?.81494140625:/P/.test(t)?.61181640625:/Q/.test(t)?.81494140625:/R/.test(t)?.65283203125:/S/.test(t)?.5771484375:/T/.test(t)?.5732421875:/U/.test(t)?.74658203125:/V/.test(t)?.67626953125:/W/.test(t)?1.017578125:/X/.test(t)?.64501953125:/Y/.test(t)?.603515625:/Z/.test(t)?.6201171875:/[0-9]/.test(t)?.58642578125:/[\u4e00-\u9fa5]/.test(t)?1:/ /.test(t)?.2958984375:/\`/.test(t)?.294921875:/\~/.test(t)?.74169921875:/\!/.test(t)?.3125:/\@/.test(t)?1.03125:/\#/.test(t)?.63818359375:/\$/.test(t)?.58642578125:/\%/.test(t)?.8896484375:/\^/.test(t)?.74169921875:/\&/.test(t)?.8701171875:/\*/.test(t)?.455078125:/\(/.test(t)?.333984375:/\)/.test(t)?.333984375:/\_/.test(t)?.4482421875:/\-/.test(t)?.4326171875:/\+/.test(t)?.74169921875:/\=/.test(t)?.74169921875:/\|/.test(t)?.26904296875:/\\/.test(t)?.416015625:/\[/.test(t)?.333984375:/\]/.test(t)?.333984375:/\;/.test(t)?.24072265625:/\'/.test(t)?.25634765625:/\,/.test(t)?.24072265625:/\./.test(t)?.24072265625:/\//.test(t)?.42724609375:/\{/.test(t)?.333984375:/\}/.test(t)?.333984375:/\:/.test(t)?.24072265625:/\"/.test(t)?.435546875:/\</.test(t)?.74169921875:/\>/.test(t)?.74169921875:/\?/.test(t)?.48291015625:1,e}function x(t){return s.default.log("进入设置图片数据方法"),new Promise(function(){var e=(0,o.default)(regeneratorRuntime.mark((function e(n,i){var r;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(e.prev=0,!t||!s.default.isArray(t)){e.next=14;break}s.default.log("images是一个数组"),r=0;case 4:if(!(r<t.length)){e.next=12;break}return s.default.log("设置图片数据循环中:"+r),e.next=8,y(t[r]);case 8:t[r]=e.sent;case 9:r++,e.next=4;break;case 12:e.next=18;break;case 14:return s.default.log("images是一个对象"),e.next=17,y(t);case 17:t=e.sent;case 18:n(t),e.next=24;break;case 21:e.prev=21,e.t0=e["catch"](0),i(e.t0);case 24:case"end":return e.stop()}}),e,null,[[0,21]])})));return function(t,n){return e.apply(this,arguments)}}())}function y(t){return new Promise(function(){var e=(0,o.default)(regeneratorRuntime.mark((function e(n,i){var r,a,o;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(!t.url){e.next=17;break}return r=t.url,e.next=4,s.default.downloadFile_PromiseFc(r);case 4:return r=e.sent,t.url=r,a=t.infoCallBack&&"function"===typeof t.infoCallBack,o={},e.next=10,s.default.getImageInfo_PromiseFc(r);case 10:o=e.sent,a&&(t=l({},t,{},t.infoCallBack(o))),t.dx=t.dx||0,t.dy=t.dy||0,t.dWidth=t.dWidth||o.width,t.dHeight=t.dHeight||o.height,t=l({},t,{imageInfo:o});case 17:n(t);case 18:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}())}function k(t,e,n){s.default.isArray(e)?s.default.log("遍历文本方法, 是数组"):(s.default.log("遍历文本方法, 不是数组"),e=[e]),s.default.log("遍历文本方法, textArray:"+JSON.stringify(e));var i=[];if(e&&e.length>0)for(var r=0;r<e.length;r++){var a=e[r];if(a.text&&a.lineFeed){var o=-1,c=n.width,u=a.size,d=a.dx;if(s.default.isObject(a.lineFeed)){var f=a.lineFeed;o=void 0!==f.lineNum&&"number"===typeof f.lineNum&&f.lineNum>=0?f.lineNum:o,c=void 0!==f.maxWidth&&"number"===typeof f.maxWidth?f.maxWidth:c,u=void 0!==f.lineHeight&&"number"===typeof f.lineHeight?f.lineHeight:u,d=void 0!==f.dx&&"number"===typeof f.dx?f.dx:d}for(var h=a.text.split(""),g="",p=[],v=0,m=h.length;v<m;v++)b(t,{text:g,size:a.size})<=c&&b(t,{text:g+h[v],size:a.size})<=c?(g+=h[v],v==h.length-1&&p.push(g)):(p.push(g),g=h[v]);s.default.log("循环出的文本数组:"+JSON.stringify(p));for(var w=o>=0&&o<p.length?o:p.length,x=0;x<w;x++){var y=p[x];x==w-1&&w<p.length&&(y=y.substring(0,y.length-1)+"...");var k=l({},a,{text:y,dx:0===x?a.dx:d>=0?d:a.dx,dy:a.dy+x*u,textLength:b(t,{text:y,size:a.size})});s.default.log("重新组成的文本对象:"+JSON.stringify(k)),i.push(k)}}else i.push(a)}s.default.log("绘制文本新数组:"+JSON.stringify(i)),C(t,i)}function S(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};if(t.font&&"string"===typeof t.font)return s.default.log(t.font),t.font;var e="normal",n="normal",i="normal",r=t.size||10,a="sans-serif";return r=Math.ceil(Number(r)),t.fontStyle&&"string"===typeof t.fontStyle&&(e=t.fontStyle.trim()),t.fontVariant&&"string"===typeof t.fontVariant&&(n=t.fontVariant.trim()),!t.fontWeight||"string"!==typeof t.fontWeight&&"number"!==typeof t.fontWeight||(i=t.fontWeight.trim()),t.fontFamily&&"string"===typeof t.fontFamily&&(a=t.fontFamily.trim()),e+" "+n+" "+i+" "+r+"px "+a}function C(t,e){if(s.default.log("准备绘制文本方法, texts:"+JSON.stringify(e)),e&&s.default.isArray(e)){if(s.default.log("准备绘制文本方法, 是数组"),e.length>0)for(var n=0;n<e.length;n++)P(t,e[n])}else s.default.log("准备绘制文本方法, 不是数组"),P(t,e)}function P(t,e){if(s.default.log("进入绘制文本方法, textItem:"+JSON.stringify(e)),e&&s.default.isObject(e)&&e.text){if(t.font=S(e),t.setFillStyle(e.color),t.setGlobalAlpha(e.alpha),t.setTextAlign(e.textAlign),t.setTextBaseline(e.textBaseline),t.fillText(e.text,e.dx,e.dy),e.lineThrough&&s.default.isObject(e.lineThrough)){s.default.log("有删除线");var n,i,r=e.lineThrough;switch(r.alpha=void 0!==r.alpha?r.alpha:e.alpha,r.style=r.style||e.color,r.width=void 0!==r.width?r.width:e.size/10,r.cap=void 0!==r.cap?r.cap:"butt",s.default.log("删除线对象:"+JSON.stringify(r)),t.setGlobalAlpha(r.alpha),t.setStrokeStyle(r.style),t.setLineWidth(r.width),t.setLineCap(r.cap),e.textAlign){case"left":n=e.dx;break;case"center":n=e.dx-e.textLength/2;break;default:n=e.dx-e.textLength;break}switch(e.textBaseline){case"top":i=e.dy+.5*e.size;break;case"middle":i=e.dy;break;default:i=e.dy-.5*e.size;break}t.beginPath(),t.moveTo(n,i),t.lineTo(n+e.textLength,i),t.stroke(),t.closePath(),s.default.log("删除线完毕")}t.setGlobalAlpha(1),t.font="10px sans-serif"}}function T(t,e){if(s.default.log("判断图片数据类型:"+JSON.stringify(e)),e&&s.default.isArray(e)){if(e.length>0)for(var n=0;n<e.length;n++)I(t,e[n])}else I(t,e)}function I(t,e){s.default.log("判断绘制图片形状, img:"+JSON.stringify(e)),e.url&&(e.circleSet?O(t,e):e.roundRectSet?_(t,e):A(t,e))}function A(t,e){if(s.default.log("进入绘制默认图片方法, img:"+JSON.stringify(e)),e.url){var n=!s.default.isUndef(e.alpha);e.alpha=Number(s.default.isUndef(e.alpha)?1:e.alpha),t.setGlobalAlpha(e.alpha),s.default.log("绘制默认图片方法, 有url"),e.dWidth&&e.dHeight&&e.sx&&e.sy&&e.sWidth&&e.sHeight?(s.default.log("绘制默认图片方法, 绘制第一种方案"),t.drawImage(e.url,e.dx||0,e.dy||0,e.dWidth||!1,e.dHeight||!1,e.sx||!1,e.sy||!1,e.sWidth||!1,e.sHeight||!1)):e.dWidth&&e.dHeight?(s.default.log("绘制默认图片方法, 绘制第二种方案"),t.drawImage(e.url,e.dx||0,e.dy||0,e.dWidth||!1,e.dHeight||!1)):(s.default.log("绘制默认图片方法, 绘制第三种方案"),t.drawImage(e.url,e.dx||0,e.dy||0)),n&&t.setGlobalAlpha(1)}s.default.log("绘制默认图片方法, 绘制完毕")}function O(t,e){s.default.log("进入绘制圆形图片方法, obj:"+JSON.stringify(e));var n,i,r,a,o=e.dx,c=e.dy,u=e.dWidth,l=e.dHeight,d=e.circleSet;e.imageInfo;("object"===typeof d&&(n=d.x,i=d.y,r=d.r),r)||(a=u>l?l:u,r=a/2);n=n?o+n:(o||0)+r,i=i?c+i:(c||0)+r,t.save(),t.beginPath(),t.arc(n,i,r,0,2*Math.PI,!1),t.closePath(),t.setGlobalAlpha(0),t.fillStyle="#FFFFFF",t.fill(),t.setGlobalAlpha(1),t.clip(),A(t,e),s.default.log("默认图片绘制完毕"),t.restore()}function _(t,e){s.default.log("进入绘制矩形图片方法, obj:"+JSON.stringify(e)),t.save();var n,i=e.dx,r=e.dy,a=e.dWidth,o=e.dHeight,c=e.roundRectSet;e.imageInfo;"object"===typeof c&&(n=c.r),n=n||.1*a,a<2*n&&(n=a/2),o<2*n&&(n=o/2),t.beginPath(),t.moveTo(i+n,r),t.arcTo(i+a,r,i+a,r+o,n),t.arcTo(i+a,r+o,i,r+o,n),t.arcTo(i,r+o,i,r,n),t.arcTo(i,r,i+a,r,n),t.closePath(),t.setGlobalAlpha(0),t.fillStyle="#FFFFFF",t.fill(),t.setGlobalAlpha(1),t.clip(),A(t,e),t.restore(),s.default.log("进入绘制矩形图片方法, 绘制完毕")}function E(t,e){s.default.log("进入绘制二维码方法"),s.default.showLoading("正在生成二维码");for(var n=[],i={text:String(e.text||"")||"",size:Number(e.size||0)||200,background:String(e.background||"")||"#ffffff",foreground:String(e.foreground||"")||"#000000",pdground:String(e.pdground||"")||"#000000",correctLevel:Number(e.correctLevel||0)||3,image:String(e.image||"")||"",imageSize:Number(e.imageSize||0)||40,dx:Number(e.dx||0)||0,dy:Number(e.dy||0)||0},r=null,a=0,o=0,u=n.length;o<u;o++)if(a=o,n[o].text==i.text&&n[o].text.correctLevel==i.correctLevel){r=n[o].obj;break}a==u&&(r=new c.default(i.text,i.correctLevel),n.push({text:i.text,correctLevel:i.correctLevel,obj:r}));for(var l=function(t){var e=t.options;return e.pdground&&(t.row>1&&t.row<5&&t.col>1&&t.col<5||t.row>t.count-6&&t.row<t.count-2&&t.col>1&&t.col<5||t.row>1&&t.row<5&&t.col>t.count-6&&t.col<t.count-2)?e.pdground:e.foreground},d=r.getModuleCount(),f=i.size,h=i.imageSize,g=(f/d).toPrecision(4),p=(f/d).toPrecision(4),v=0;v<d;v++)for(var m=0;m<d;m++){var b=Math.ceil((m+1)*g)-Math.floor(m*g),w=Math.ceil((v+1)*g)-Math.floor(v*g),x=l({row:v,col:m,count:d,options:i});t.setFillStyle(r.modules[v][m]?x:i.background),t.fillRect(i.dx+Math.round(m*g),i.dy+Math.round(v*p),b,w)}if(i.image){var y=function(t,e,n,r,a,o,s,c,u){t.setLineWidth(s),t.setFillStyle(i.background),t.setStrokeStyle(i.background),t.beginPath(),t.moveTo(e+o,n),t.arcTo(e+r,n,e+r,n+o,o),t.arcTo(e+r,n+a,e+r-o,n+a,o),t.arcTo(e,n+a,e,n+a-o,o),t.arcTo(e,n,e+o,n,o),t.closePath(),c&&t.fill(),u&&t.stroke()},k=i.dx+Number(((f-h)/2).toFixed(2)),S=i.dy+Number(((f-h)/2).toFixed(2));y(t,k,S,h,h,2,6,!0,!0),t.drawImage(i.image,k,S,h,h)}s.default.log("进入绘制二维码方法完毕"),s.default.hideLoading()}function N(t){t.backgroundImage,t.type;return new Promise(function(){var e=(0,o.default)(regeneratorRuntime.mark((function e(n,i){var r,a,o,c,u,d,f,h,g;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(e.prev=0,s.default.showLoading("正在获取海报背景图"),r=!1,s.default.log("获取的缓存:"+JSON.stringify(r)),!(r&&r.path&&r.name)){e.next=52;break}return s.default.log("海报有缓存, 准备获取后端背景图进行对比"),e.next=8,s.default.getPosterUrl(t);case 8:if(a=e.sent,s.default.log("准备对比name是否相同"),r.name!==s.default.fileNameInPath(a)){e.next=44;break}return s.default.log("name相同, 判断该背景图是否存在于本地"),e.next=14,s.default.checkFile_PromiseFc(r.path);case 14:if(o=e.sent,!(o>=0)){e.next=36;break}return s.default.log("海报save路径存在, 对比宽高信息, 存储并输出"),e.next=19,s.default.getImageInfo_PromiseFc(r.path);case 19:if(c=e.sent,u=l({},r),r.width&&r.height&&r.width===c.width&&r.height===c.height){e.next=30;break}return s.default.log("宽高对比不通过， 重新获取"),e.next=25,D(t,a);case 25:d=e.sent,s.default.hideLoading(),n(d),e.next=34;break;case 30:s.default.log("宽高对比通过, 再次存储, 并返回路径"),u=l({},r,{width:c.width,height:c.height}),s.default.hideLoading(),n(u);case 34:e.next=42;break;case 36:return s.default.log("海报save路径不存在, 重新获取海报"),e.next=39,D(t,a);case 39:f=e.sent,s.default.hideLoading(),n(f);case 42:e.next=50;break;case 44:return s.default.log("name不相同, 重新获取海报"),e.next=47,D(t,a);case 47:h=e.sent,s.default.hideLoading(),n(h);case 50:e.next=58;break;case 52:return s.default.log("海报背景图没有缓存, 准备获取海报背景图"),e.next=55,D(t);case 55:g=e.sent,s.default.hideLoading(),n(g);case 58:e.next=66;break;case 60:e.prev=60,e.t0=e["catch"](0),s.default.hideLoading(),s.default.showToast("获取分享用户背景图失败:"+JSON.stringify(e.t0)),s.default.log(JSON.stringify(e.t0)),i(e.t0);case 66:case"end":return e.stop()}}),e,null,[[0,60]])})));return function(t,n){return e.apply(this,arguments)}}())}function L(t){var e=F(t),n=s.default.getStorageSync(e);n&&n.path&&(s.default.removeSavedFile(n.path),s.default.removeStorageSync(e))}function F(t){return d+(t||"default")}function D(t,e){t.backgroundImage;var n=t.type;return s.default.log("获取分享背景图, 尝试清空本地数据"),L(n),new Promise(function(){var n=(0,o.default)(regeneratorRuntime.mark((function n(i,r){var a,o,c,u,d,f,h,g;return regeneratorRuntime.wrap((function(n){while(1)switch(n.prev=n.next){case 0:if(n.prev=0,s.default.showLoading("正在下载海报背景图"),!e){n.next=23;break}return s.default.log("有从后端获取的背景图片路径"),s.default.log("尝试下载并保存背景图"),a=s.default.fileNameInPath(e),n.next=8,s.default.downLoadAndSaveFile_PromiseFc(e);case 8:if(o=n.sent,!o){n.next=19;break}return s.default.log("下载并保存背景图成功:"+o),n.next=13,s.default.getImageInfo_PromiseFc(o);case 13:c=n.sent,u={path:o,width:c.width,height:c.height,name:a},s.default.hideLoading(),i(u),n.next=21;break;case 19:s.default.hideLoading(),r("not find savedFilePath");case 21:n.next=46;break;case 23:return s.default.log("没有从后端获取的背景图片路径, 尝试从后端获取背景图片路径"),n.next=26,s.default.getPosterUrl(t);case 26:return d=n.sent,s.default.log("尝试下载并保存背景图:"+d),n.next=30,s.default.downLoadAndSaveFile_PromiseFc(d);case 30:if(f=n.sent,!f){n.next=44;break}return s.default.log("下载并保存背景图成功:"+f),n.next=35,s.default.getImageInfo_PromiseFc(f);case 35:h=n.sent,s.default.log("获取图片信息成功"),g={path:f,width:h.width,height:h.height,name:s.default.fileNameInPath(d)},s.default.log("拼接背景图信息对象成功:"+JSON.stringify(g)),s.default.hideLoading(),s.default.log("返回背景图信息对象"),i(l({},g)),n.next=46;break;case 44:s.default.hideLoading(),r("not find savedFilePath");case 46:n.next=51;break;case 48:n.prev=48,n.t0=n["catch"](0),r(n.t0);case 51:case"end":return n.stop()}}),n,null,[[0,48]])})));return function(t,e){return n.apply(this,arguments)}}())}t.exports={getSharePoster:h,setText:v,setImage:x,drawText:k,drawImage:T,drawQrCode:E}},ec54:function(t,e,n){"use strict";var i,r=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("v-uni-view",{staticClass:"goods-info-box"},[t.infor.url.length?n("v-uni-image",{attrs:{src:t.infor.url,mode:"aspectFill"}}):t._e(),n("v-uni-view",{staticClass:"content"},[n("v-uni-view",{staticClass:"title"},[t._v(t._s(t.infor.name))]),n("v-uni-view",{staticClass:"desc"}),n("v-uni-view",{staticClass:"rule"},[n("v-uni-text",[t._v(t._s(t.infor.originalPrice))]),n("v-uni-text",[t._v(t._s(t.infor.price))])],1)],1),n("v-uni-view",{staticClass:"selected",class:t.checked?"active":""})],1)},a=[];n.d(e,"b",(function(){return r})),n.d(e,"c",(function(){return a})),n.d(e,"a",(function(){return i}))},f410:function(t,e,n){n("1af6"),t.exports=n("584a").Array.isArray},f45c:function(t,e,n){"use strict";n.r(e);var i=n("1ee4"),r=n.n(i);for(var a in i)"default"!==a&&function(t){n.d(e,t,(function(){return i[t]}))}(a);e["default"]=r.a},f52d:function(t,e,n){var i=n("7213");"string"===typeof i&&(i=[[t.i,i,""]]),i.locals&&(t.exports=i.locals);var r=n("4f06").default;r("34fa11eb",i,!0,{sourceMap:!1,shadowMode:!1})}}]);