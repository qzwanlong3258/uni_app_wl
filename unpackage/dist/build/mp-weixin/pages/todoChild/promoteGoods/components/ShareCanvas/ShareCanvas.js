(global["webpackJsonp"]=global["webpackJsonp"]||[]).push([["pages/todoChild/promoteGoods/components/ShareCanvas/ShareCanvas"],{"3cf0":function(t,n,e){"use strict";e.r(n);var i=e("999c"),a=e("b6c2");for(var o in a)"default"!==o&&function(t){e.d(n,t,function(){return a[t]})}(o);e("b101");var r=e("2877"),s=Object(r["a"])(a["default"],i["a"],i["b"],!1,null,"e45403a4",null);n["default"]=s.exports},6299:function(t,n,e){},"6d49":function(t,n,e){"use strict";(function(t){Object.defineProperty(n,"__esModule",{value:!0}),n.default=void 0;var i=c(e("a34a")),a=s(e("5cd2")),o=e("5e5c"),r=e("6e47");function s(t){if(t&&t.__esModule)return t;var n={};if(null!=t)for(var e in t)if(Object.prototype.hasOwnProperty.call(t,e)){var i=Object.defineProperty&&Object.getOwnPropertyDescriptor?Object.getOwnPropertyDescriptor(t,e):{};i.get||i.set?Object.defineProperty(n,e,i):n[e]=t[e]}return n.default=t,n}function c(t){return t&&t.__esModule?t:{default:t}}function h(t,n,e,i,a,o,r){try{var s=t[o](r),c=s.value}catch(h){return void e(h)}s.done?n(c):Promise.resolve(c).then(i,a)}function u(t){return function(){var n=this,e=arguments;return new Promise(function(i,a){var o=t.apply(n,e);function r(t){h(o,i,a,r,s,"next",t)}function s(t){h(o,i,a,r,s,"throw",t)}r(void 0)})}}var d={data:function(){return{canvas:null,canvasComponent:null,hideShareCanvas:!0,shareCanvas:null,hideBtnSet:!1,hideBox:!0,downloadImg:o.DOWNLOAD_IMG,qRCodeUrl:""}},props:{width:{type:Number,required:!0},height:{type:Number,required:!0},config:{type:Object,defautl:function(){return{}}}},mounted:function(){this.canvasComponent=wx.createCanvasContext("canvas",this)},methods:{checkPermission:function(){var t=this;this.canvas&&this.canvas.checkPermission().then(function(n){n.code==a.renum.UNAUTHORIZED?t.showJump():n.code==a.renum.NOPERMISSION||n.code==a.renum.HASPERMISSION?t.showShareCanvas():console.warn("检测权限返回结果错误")})},junpAuthorization:function(){a.IWX.invoke("openSetting")},showBox:function(){this.hideBox=!1},showShareCanvas:function(){this.hideBox=!1,this.hideShareCanvas=!1,this.hideBtnSet=!1},showJump:function(){this.hideBox=!1,this.hideShareCanvas=!1,this.hideBtnSet=!0},hideCanvas:function(t){t!=a.renum.INITIATIVE&&"box"!=t.currentTarget.dataset.mark||(this.hideBox=!0,this.hideShareCanvas=!0)},switchAuthorization:function(){this.hideCanvas(a.renum.INITIATIVE),this.hideBtnSet=!0},saveForAlubm:function(){var t=this;this.getTempImgPath().then(function(n){t.canvas.saveImgLocal(n).then(function(n){t.hideCanvas(a.renum.INITIATIVE)}).catch(function(n){t.switchAuthorization()})})},drawShareCanvas:function(){var n=this;this.canvas.draw().then(function(t){n.showShareCanvas()}).catch(function(t){t.code==a.renum.UNAUTHORIZED&&n.showJump()}).then(function(n){t.hideLoading()})},share:function(){var n=u(i.default.mark(function n(){return i.default.wrap(function(n){while(1)switch(n.prev=n.next){case 0:if(n.t0=!this.miniCodeUrl,!n.t0){n.next=5;break}return n.next=4,this.genderMiniCode();case 4:this.miniCodeUrl=n.sent;case 5:null===this.canvas?(t.showLoading({title:"正在加载"}),this.canvas=new a.default({ctx:this.canvasComponent,imgUrl:this.config.imgUrl,qRCodeUrl:this.qRCodeUrl,title:this.config.title,price:this.config.price,width:this.width,height:this.height,qRCodeWidth:280}),this.checkPermission(),this.showBox(),this.drawShareCanvas()):(this.showBox(),this.canvas.isDraw||this.drawShareCanvas(),this.checkPermission());case 6:case"end":return n.stop()}},n,this)}));function e(){return n.apply(this,arguments)}return e}(),getTempImgPath:function(){var n=this;return new Promise(function(e,i){t.canvasToTempFilePath({x:0,y:0,canvasId:"canvas",success:function(t){e(t.tempFilePath)},fail:function(t){console.error(t)}},n)})},genderMiniCode:function(){var t=this;return(0,r.getUnlimited)({page:this.config.jumpPath,scene:this.config.scene,width:600,is_hyaline:!0}).then(function(n){t.qRCodeUrl=n}).catch(function(n){t.hideCanvas(a.renum.INITIATIVE)})}}};n.default=d}).call(this,e("543d")["default"])},"999c":function(t,n,e){"use strict";var i=function(){var t=this,n=t.$createElement;t._self._c},a=[];e.d(n,"a",function(){return i}),e.d(n,"b",function(){return a})},b101:function(t,n,e){"use strict";var i=e("6299"),a=e.n(i);a.a},b6c2:function(t,n,e){"use strict";e.r(n);var i=e("6d49"),a=e.n(i);for(var o in i)"default"!==o&&function(t){e.d(n,t,function(){return i[t]})}(o);n["default"]=a.a}}]);
;(global["webpackJsonp"] = global["webpackJsonp"] || []).push([
    'pages/todoChild/promoteGoods/components/ShareCanvas/ShareCanvas-create-component',
    {
        'pages/todoChild/promoteGoods/components/ShareCanvas/ShareCanvas-create-component':(function(module, exports, __webpack_require__){
            __webpack_require__('543d')['createComponent'](__webpack_require__("3cf0"))
        })
    },
    [['pages/todoChild/promoteGoods/components/ShareCanvas/ShareCanvas-create-component']]
]);
